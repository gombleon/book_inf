<!DOCTYPE html>
<html>
<head>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({
  config: ["MMLorHTML.js"],
  jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML"],
  extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js"],
  TeX: {
    extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
  }
});
    </script>
    <script type="text/javascript"
            src="https://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <meta charset="UTF-8"/>
    <link rel='stylesheet' type="text/css" href="style.css"></link>
    <meta name="author" content="dima"/>
    <meta name="description" content="Математика биткойна"/>
    <meta name="keywords"
          content="биткойн, криптосистема на эллиптических кривых, конечные поля, открытый ключ, секретный ключ"/>
    <title>Математика биткойна</title>

    <script type="text/javascript">

        //вычисляем вычет
        function f_mod(n, p) {
            var t = Number(n), p = Number(p);
            t = t % p;
            if (t < 0) {
                t = t + p;
            }
            return t;
        }

        //если число простое, то возвращает 1
        function prost(mod_p) {
            var i = 2, gran = (mod_p - (mod_p % 2)) / 2 + 1;
            while ((i < gran) && ((mod_p % i) > 0))
                i++;
            if (i < gran) {
                return 0
            } else {
                return 1
            }
        }

        //вычисляем число, обратное числу num по модулю mod_p
        function f_rever(mod_p, num) {
            var i = 1;
            while (((i * num) % mod_p) != 1) {
                i++;
            }
            return i
        }

        //проверяем на принадлежность эллиптической кривой
        function elliptic(mod_p, px, py) {
            var temp, lf, rt;
            lf = py * py;
            lf = f_mod(lf, mod_p);
            rt = px * px * px + 7;
            rt = f_mod(rt, mod_p);
            if (lf == rt) {
                return 1;
            } else {
                return 0;
            }
        }

        //функция удвоения точки
        function f_double(mod_p, x, y) {
            var lambda, i, temp, mas_r = [];
            if (y == 0) {
                mas_r[0] = 'x';
                mas_r[1] = String.fromCharCode(8734);
            } else {
                temp = 2 * y;
                temp = f_mod(temp, mod_p);
                i = 1;
                while (((temp * i) % mod_p) > 1)
                    i++;
                temp = i * 3 * x * x;
                lambda = f_mod(temp, mod_p);
                temp = lambda * lambda - 2 * x;
                mas_r[0] = f_mod(temp, mod_p);
                temp = -lambda * (mas_r[0] - x) - y;
                mas_r[1] = f_mod(temp, mod_p);
            }
            return mas_r;
        }


        //генерируем эллиптическую кривую
        function f1() {
            var mod_p = document.getElementById("module").value, i = 2, j, gran, mas_x = new Array(),
                mas_y = new Array(), result = "{";
            gran = (mod_p - (mod_p % 2)) / 2 + 1;
            while ((i < gran) && ((mod_p % i) > 0))
                i++;
            if (i < gran) {
                document.getElementById("text_result").value = "Ошибка! Задайте простое число.";
            } else {
                for (i = 0; i < mod_p; i++) {
                    mas_x[i] = (i * i * i + 7) % mod_p;
                    mas_y[i] = (i * i) % mod_p;
                }
                for (i = 0; i < mod_p; i++) {
                    for (j = 0; j < mod_p; j++) {
                        if (mas_x[i] == mas_y[j]) {
                            result = result + "(" + i + ", " + j + "),";
                        }
                    }
                }
                document.getElementById("text_result").value = result + "O(x; " + String.fromCharCode(8734) + ")"
            }
        }

        //вычисляем сумму двух точек эллиптической кривой
        function sum(mod_p, x1, y1, x2, y2) {
            var lambda, i, x3, y3, temp, result = [];
            s1 = document.createElement("span");
            temp = x2 - x1;
            if (temp == 0) {
                result[0] = 'x';
                result[1] = String.fromCharCode(8734);
            } else {
                if (x1 == 'x') {
                    result[0] = x2;
                    result[1] = y2;
                } else {
                    if (x2 == 'x') {
                        result[0] = x1;
                        result[1] = y1;
                    } else {
                        temp = f_mod(temp, mod_p);
                        i = 1;
                        while (((temp * i) % mod_p) > 1)
                            i++;
                        temp = i * (y2 - y1);
                        lambda = f_mod(temp, mod_p);
                        temp = lambda * lambda - x1 - x2;
                        x3 = f_mod(temp, mod_p);
                        temp = -y1 - lambda * (x3 - x1);
                        y3 = f_mod(temp, mod_p);
                        result[0] = x3;
                        result[1] = y3;
                    }
                }

            }
            return result;
        }

        //функция скалярного произведения (для вычисления подписи)
        function scal_pr(mod_p, n, x, y) {
            var stepen = [], cluch = [], stroka = '', len, i, j;
            while (n > 0) {
                if (n % 2 == 1) {
                    stroka = '1' + stroka;
                } else {
                    stroka = '0' + stroka;
                }
                n = (n - (n % 2)) / 2;
            }
            len = stroka.length;
            i = len - 1;
            stepen[0] = x;
            stepen[1] = y;
            j = 1;
            while (stroka.charAt(i) == '0' && i > 0) {
                stepen = f_double(mod_p, stepen[0], stepen[1]);
                j = 2 * j;
                i = i - 1;
            }
            cluch[0] = stepen[0];
            cluch[1] = stepen[1];
            while (i > 0) {
                i = i - 1;
                stepen = f_double(mod_p, stepen[0], stepen[1]);
                j = 2 * j;
                if (stroka.charAt(i) == '1') {
                    cluch = sum(mod_p, cluch[0], cluch[1], stepen[0], stepen[1]);
                }
            }
            return cluch;
        }

        //скалярное произведение
        function multipl(mod_p, n, x, y) {
            var stepen = [], cluch = [], stroka = '', len, i, j, myWin = open("", "newWindow"), p, html, head, title,
                body, table, caption, tr, td, h2, str_step = '', str_cluch = '', str_n = '', n_1 = n;
            myWin.document.open();
            html = document.createElement("html");
            myWin.document.appendChild(html);
            head = document.createElement("head");
            title = document.createElement("title");
            title.textContent = "Скалярное произведение натурального числа на базовую точку";
            head.appendChild(title);
            html.appendChild(head);
            body = document.createElement("body");
            html.appendChild(body);
            h2 = document.createElement("h2");
            h2.textContent = "Скалярное произведение натурального числа на базовую точку";
            body.appendChild(h2);
            p = document.createElement("p");
            p.textContent = 'Модуль конечного поля p=' + String(mod_p);
            body.appendChild(p);
            p = document.createElement("p");
            p.textContent = 'Базовая точка P=(' + String(x) + ';' + String(y) + ')';
            body.appendChild(p);
            p = document.createElement("p");
            p.textContent = 'Множитель n=' + String(n);
            body.appendChild(p);
            str_n = String(n);
            while (n > 0) {
                if (n % 2 == 1) {
                    stroka = '1' + stroka;
                } else {
                    stroka = '0' + stroka;
                }
                n = (n - (n % 2)) / 2;
            }
            p = document.createElement("p");
            p.textContent = str_n + ' в двоичной системе счисления: ' + stroka;
            body.appendChild(p);
            len = stroka.length;
            i = len - 1;
            stepen[0] = x;
            stepen[1] = y;
            j = 1;
            str_step = String(j) + 'P=(' + String(stepen[0]) + ';' + String(stepen[1]) + '), ';
            p = document.createElement("p");
            p.textContent = str_step;
            body.appendChild(p);
            while (stroka.charAt(i) == '0' && i > 0) {
                stepen = f_double(mod_p, stepen[0], stepen[1]);
                j = 2 * j;
                str_step = String(j) + 'P=(' + String(stepen[0]) + ';' + String(stepen[1]) + '), ';
                p = document.createElement("p");
                p.textContent = str_step;
                body.appendChild(p);
                i = i - 1;
            }
            cluch[0] = stepen[0];
            cluch[1] = stepen[1];
            str_cluch = 'G=(' + String(cluch[0]) + ';' + String(cluch[1]) + ')';
            while (i > 0) {
                i = i - 1;
                stepen = f_double(mod_p, stepen[0], stepen[1]);
                j = 2 * j;
                str_step = String(j) + 'P=(' + String(stepen[0]) + ';' + String(stepen[1]) + '), ';
                p = document.createElement("p");
                p.textContent = str_step;
                body.appendChild(p);
                if (stroka.charAt(i) == '1') {
                    cluch = sum(mod_p, cluch[0], cluch[1], stepen[0], stepen[1]);
                    str_cluch = str_cluch + '+(' + String(stepen[0]) + ';' + String(stepen[1]) + ')';
                }
            }
            p = document.createElement("p");
            p.textContent = str_cluch;
            body.appendChild(p)
            str_cluch = 'Искомое произведение ' + String(n_1) + 'P=(' + String(cluch[0]) + ';' + String(cluch[1]) + ').';
            p = document.createElement("p");
            p.textContent = str_cluch;
            body.appendChild(p)
            myWin.document.close();
        }

        function gen_cluch(mod_p, n, x, y) {
            var arr_res = [], f4result = document.getElementById("f4result");
            if (prost(mod_p) == 0) {
                alert("Ошибка! Задайте простое число.")
            } else {
                if (elliptic(mod_p, x, y) < 1) {
                    alert("Ошибка! Задайте точку из эллиптической кривой.")
                } else {
                    multipl(mod_p, n, x, y);
                }
            }
        }

        function sumf2(mod_p, x1, y1, x2, y2) {
            var arr_res = [], f2result = document.getElementById("f2result");
            if (prost(mod_p) == 0) {
                alert("Ошибка! Задайте простое число.")
            } else {
                if (elliptic(mod_p, x1, y1) + elliptic(mod_p, x2, y2) < 2) {
                    alert("Ошибка! Задайте точки из эллиптической кривой.")
                } else {
                    arr_res = sum(mod_p, x1, y1, x2, y2);
                    s1 = document.createElement("span");
                    s1.textContent = "(" + arr_res[0] + ";" + arr_res[1] + ")";
                    f2result.appendChild(s1);
                }
            }
        }

        function f3double(mod_p, x, y) {
            var arr_res = [], f3result = document.getElementById("f3result"), s1 = document.createElement("span");
            if (prost(mod_p) == 0) {
                alert("Ошибка! Задайте простое число.")
            } else {
                if (elliptic(mod_p, x, y) == 0) {
                    alert("Ошибка! Задайте точки из эллиптической кривой.")
                } else {
                    arr_res = f_double(mod_p, x, y);
                    s1.textContent = "(" + arr_res[0] + ";" + arr_res[1] + ")";
                    f3result.appendChild(s1);
                }
            }
        }

        //вычисляем порядок базовой точки
        function gen_por(mod_p, x, y) {
            var arr_res = [], f5result = document.getElementById("f5result"), s1 = document.createElement("span"), n;
            if (prost(mod_p) == 0) {
                alert("Ошибка! Задайте простое число.")
            } else {
                if (elliptic(mod_p, x, y) == 0) {
                    alert("Ошибка! Задайте точку из эллиптической кривой.")
                } else {
                    arr_res = f_double(mod_p, x, y);
                    n = 2;
                    while (arr_res[0] != 'x') {
                        arr_res = sum(mod_p, arr_res[0], arr_res[1], x, y)
                        n++;
                    }
                    s1.textContent = "порядок базовой точки равен " + n;
                    f5result.appendChild(s1);
                }
            }
        }

        function gen_open1(mod_p, s, q, x, y) {
            var stepen = [], cluch = [], stroka = '', len, i, j, myWin = open("", "newWindow"), p, html, head, title,
                body, table, caption, tr, td, h2, str_step = '', str_cluch = '', str_s = '', s_1 = s;
            myWin.document.open();
            html = document.createElement("html");
            myWin.document.appendChild(html);
            head = document.createElement("head");
            title = document.createElement("title");
            title.textContent = "Генерирование открытого ключа владельца биткойна";
            head.appendChild(title);
            html.appendChild(head);
            body = document.createElement("body");
            html.appendChild(body);
            h2 = document.createElement("h2");
            h2.textContent = "Генерирование открытого ключа владельца биткойна";
            body.appendChild(h2);
            p = document.createElement("p");
            p.textContent = 'Модуль конечного поля p=' + String(mod_p);
            body.appendChild(p);
            p = document.createElement("p");
            p.textContent = 'Базовая точка P=(' + String(x) + ';' + String(y) + ')';
            body.appendChild(p);
            p = document.createElement("p");
            p.textContent = 'Порядок базовой точки q=' + String(q);
            body.appendChild(p);
            p = document.createElement("p");
            p.textContent = 'Секретный ключ s=' + String(s);
            body.appendChild(p);
            str_s = String(s);
            while (s > 0) {
                if (s % 2 == 1) {
                    stroka = '1' + stroka;
                } else {
                    stroka = '0' + stroka;
                }
                s = (s - (s % 2)) / 2;
            }
            p = document.createElement("p");
            p.textContent = str_s + ' в двоичной системе счисления: ' + stroka;
            body.appendChild(p);
            len = stroka.length;
            i = len - 1;
            stepen[0] = x;
            stepen[1] = y;
            j = 1;
            str_step = String(j) + 'P=(' + String(stepen[0]) + ';' + String(stepen[1]) + '), ';
            p = document.createElement("p");
            p.textContent = str_step;
            body.appendChild(p);
            while (stroka.charAt(i) == '0' && i > 0) {
                stepen = f_double(mod_p, stepen[0], stepen[1]);
                j = 2 * j;
                str_step = String(j) + 'P=(' + String(stepen[0]) + ';' + String(stepen[1]) + '), ';
                p = document.createElement("p");
                p.textContent = str_step;
                body.appendChild(p);
                i = i - 1;
            }
            cluch[0] = stepen[0];
            cluch[1] = stepen[1];
            str_cluch = 'Q=(' + String(cluch[0]) + ';' + String(cluch[1]) + ')';
            while (i > 0) {
                i = i - 1;
                stepen = f_double(mod_p, stepen[0], stepen[1]);
                j = 2 * j;
                str_step = String(j) + 'P=(' + String(stepen[0]) + ';' + String(stepen[1]) + '), ';
                p = document.createElement("p");
                p.textContent = str_step;
                body.appendChild(p);
                if (stroka.charAt(i) == '1') {
                    cluch = sum(mod_p, cluch[0], cluch[1], stepen[0], stepen[1]);
                    str_cluch = str_cluch + '+(' + String(stepen[0]) + ';' + String(stepen[1]) + ')';
                }
            }
            p = document.createElement("p");
            p.textContent = str_cluch;
            body.appendChild(p)
            str_cluch = 'Искомый открытый ключ ' + String(s_1) + 'Q=(' + String(cluch[0]) + ';' + String(cluch[1]) + ').';
            p = document.createElement("p");
            p.textContent = str_cluch;
            body.appendChild(p)
            myWin.document.close();
        }

        //генерируем открытый ключ
        function gen_open(f6mod, f6s, f6q, f6x, f6y) {
            var mult = [];
            if (prost(f6mod) == 0) {
                alert("Ошибка! Задайте в качестве модуля поля простое число.")
            } else {
                if (elliptic(f6mod, f6x, f6y) == 0) {
                    alert("Ошибка! Задайте точку из эллиптической кривой.")
                } else {
                    mult = scal_pr(f6mod, f6q, f6x, f6y);
                    if ((mult[0] != 'x') || (prost(f6q) == 0)) {
                        alert("Ошибка! Задайте правильно базовую точку с простым порядком.")
                    } else {
                        if ((f6s > 1) && (f6s <= f6q - 1)) {
                            gen_open1(f6mod, f6s, f6q, f6x, f6y);
                        } else {
                            alert("Ошибка! Задайте правильно секретный ключ.")
                        }
                    }
                }
            }
        }

        function gen_podpis1(f7mod, f7z, f7s, f7q, f7k, f7x, f7y) {
            var mult = [], ry = 0, k1 = 1, myWin = open("", "newWindow"), p, html, head, title, body, h2, p;
            myWin.document.open();
            html = document.createElement("html");
            myWin.document.appendChild(html);
            head = document.createElement("head");
            title = document.createElement("title");
            title.textContent = "Генерирование подписи владельца биткойна";
            head.appendChild(title);
            html.appendChild(head);
            body = document.createElement("body");
            html.appendChild(body);
            h2 = document.createElement("h2");
            h2.textContent = "Генерирование подписи владельца биткойна";
            body.appendChild(h2);
            p = document.createElement("p");
            p.textContent = 'Модуль конечного поля p=' + String(f7mod);
            body.appendChild(p);
            p = document.createElement("p");
            p.textContent = 'Базовая точка P=(' + String(f7x) + ';' + String(f7y) + ')';
            body.appendChild(p);
            p = document.createElement("p");
            p.textContent = 'Порядок базовой точки =' + String(f7q);
            body.appendChild(p);
            p = document.createElement("p");
            p.textContent = 'Секретный ключ =' + String(f7s);
            body.appendChild(p);
            p = document.createElement("p");
            p.textContent = 'Хэш =' + String(f7z);
            body.appendChild(p);
            p = document.createElement("p");
            p.textContent = 'Случайное число =' + String(f7k);
            body.appendChild(p);
            mult = scal_pr(f7mod, f7k, f7x, f7y);
            if (mult[0] == 0) {
                p = document.createElement("p");
                p.textContent = 'rx=0, выберите другое случайное число';
                body.appendChild(p);
            } else {
                while (((k1 * f7k) % f7q) > 1) {
                    k1++;
                }
                p = document.createElement("p");
                p.textContent = 'Число, обратное к числу ' + String(f7k) + ' равно ' + String(k1) + '( по модулю ' + String(f7q) + ')';
                body.appendChild(p);
                p = document.createElement("p");
                p.textContent = 'rx= ' + String(mult[0]);
                body.appendChild(p);
                ry = ((Number(f7z) + Number(mult[0] * f7s)) * k1) % f7q;
                p = document.createElement("p");
                p.textContent = 'ry= ' + String(ry);
                body.appendChild(p);
                p = document.createElement("p");
                p.textContent = 'Искомая подпись: ' + String(mult[0]) + String(ry);
                body.appendChild(p);
                myWin.document.close();
            }
        }

        //генерируем подпись
        function gen_podpis(f7mod, f7z, f7s, f7q, f7k, f7x, f7y) {
            var mult = [];
            if (prost(f7mod) == 0) {
                alert("Ошибка! Задайте в качестве модуля поля простое число.")
            } else {
                if (elliptic(f7mod, f7x, f7y) == 0) {
                    alert("Ошибка! Задайте точку из эллиптической кривой.")
                } else {
                    mult = scal_pr(f7mod, f7q, f7x, f7y);
                    if ((mult[0] != 'x') || (prost(f7q) == 0)) {
                        alert("Ошибка! Задайте правильно базовую точку с простым порядком.")
                    } else {
                        if ((f7s <= 1) || (f7s > f6q - 1)) {
                            alert("Ошибка! Задайте правильно секретный ключ.")
                        } else {
                            if ((f7k <= 1) || (f7k > f6q - 1)) {
                                alert("Ошибка! Задайте правильно случайное число k.")
                            } else {
                                gen_podpis1(f7mod, f7z, f7s, f7q, f7k, f7x, f7y);
                            }
                        }
                    }
                }
            }
        }

        function prov_podpis1(f8mod, f8px, f8py, f8p, f8qx, f8qy, f8z, f8rx, f8ry) {
            var w = 1, u, v, up = [], vq = [], xy = [], rxmodp = 1, xmodp = 1, myWin = open("", "newWindow"), p, html,
                head, title, body, h2;
            myWin.document.open();
            html = document.createElement("html");
            myWin.document.appendChild(html);
            head = document.createElement("head");
            title = document.createElement("title");
            title.textContent = "Проверка подписи владельца биткойна";
            head.appendChild(title);
            html.appendChild(head);
            body = document.createElement("body");
            html.appendChild(body);
            h2 = document.createElement("h2");
            h2.textContent = "Проверка подписи владельца биткойна";
            body.appendChild(h2);
            p = document.createElement("p");
            p.textContent = 'Модуль конечного поля p=' + String(f8mod);
            body.appendChild(p);
            p = document.createElement("p");
            p.textContent = 'Базовая точка P=(' + String(f8px) + ';' + String(f8py) + ')';
            body.appendChild(p);
            p = document.createElement("p");
            p.textContent = 'Порядок базовой точки =' + String(f8p);
            body.appendChild(p);
            p = document.createElement("p");
            p.textContent = 'Публичный ключ Q=(' + String(f8qx) + ';' + String(f8qy) + ')';
            body.appendChild(p);
            p = document.createElement("p");
            p.textContent = 'Хэш =' + String(f8z);
            body.appendChild(p);
            p = document.createElement("p");
            p.textContent = 'Подпись владельца биткойна =(' + String(f8rx) + ';' + String(f8ry) + ')';
            body.appendChild(p);
            while (((w * f8ry) % f8p) != 1) {
                w++;
            }
            p = document.createElement("p");
            p.textContent = 'Обратное к ry по модулю p значение w=' + String(w);
            body.appendChild(p);
            u = (f8z * w) % f8p;
            p = document.createElement("p");
            p.textContent = 'Произведение хэша z и числа w по модулю p равно u=' + String(u);
            body.appendChild(p);
            v = (f8rx * w) % f8p;
            p = document.createElement("p");
            p.textContent = 'Произведение компонента rx подписи и числа w по модулю p равно v=' + String(v);
            body.appendChild(p);
            up = scal_pr(f8mod, u, f8px, f8py);
            p = document.createElement("p");
            p.textContent = 'Скалярное произведение числа u на базовую точку P =(' + up[0] + ';' + up[1] + ')';
            body.appendChild(p);
            vq = scal_pr(f8mod, v, f8qx, f8qy);
            p = document.createElement("p");
            p.textContent = 'Скалярное произведение числа v на публичный ключ =(' + vq[0] + ';' + vq[1] + ')';
            body.appendChild(p);
            xy = sum(f8mod, up[0], up[1], vq[0], vq[1]);
            p = document.createElement("p");
            p.textContent = 'Сумма последних двух точек (x; y)=' + xy[0] + ';' + xy[1] + ')';
            body.appendChild(p);
            rxmodp = f8rx % f8p;
            p = document.createElement("p");
            p.textContent = 'Компонент rx подписи по модулю p =' + rxmodp;
            body.appendChild(p);
            xmodp = xy[0] % f8p;
            p = document.createElement("p");
            p.textContent = 'Компонент x точки (x; y) по модулю p =' + xmodp;
            body.appendChild(p);
            p = document.createElement("p");
            if (rxmodp == xmodp) {
                p.textContent = 'x и rx по модулю p совпали, следовательно, подпись действительна.';
            } else {
                p.textContent = 'x и rx по модулю p не совпали, следовательно, подпись недействительна.';
            }
            body.appendChild(p);
            myWin.document.close();
        }

        function prov_podpis(f8mod, f8px, f8py, f8p, f8qx, f8qy, f8z, f8rx, f8ry) {
            var mult = [];
            if (prost(f8mod) == 0) {
                alert("Ошибка! Задайте в качестве модуля поля простое число.")
            } else {
                if (elliptic(f8mod, f8px, f8py) == 0) {
                    alert("Ошибка! Задайте точку из эллиптической кривой.")
                } else {
                    mult = scal_pr(f8mod, f8p, f8px, f8py);
                    if ((mult[0] != 'x') || (prost(f8p) == 0)) {
                        alert("Ошибка! Задайте базовую точку с простым порядком.")
                    } else {
                        if ((f8rx <= 1) || (f8rx > f8p - 1) || (f8ry <= 1) || (f8ry > f8p - 1)) {
                            alert("Ошибка! Компоненты подписи не принадлежат интервалу от 1 до p-1.")
                        } else {
                            prov_podpis1(f8mod, f8px, f8py, f8p, f8qx, f8qy, f8z, f8rx, f8ry);
                        }
                    }
                }
            }
        }
    </script>
</head>
<body>
<p><a href="6_5.html">К предыдущему</a> <a href="index.html">К содержанию</a> <a href="7_1.html">К следующему</a></p>
<h2>6.6. Математика биткойна</h2>

<p>ECDSA — это акроним для Алгоритма Цифровой Подписи с Эллиптическими Кривыми. Это процесс, который использует
    эллиптические кривые и конечные поля, чтобы &quot;подписать&quot; данные таким образом, что третьи лица могут легко
    проверить подлинность подписи, но при этом сам подписывающий оставляет за собой эксклюзивную возможность создавать
    подписи.</p>
<p>ECDSA имеет две отдельные процедуры для подписи и ее проверки. Каждая процедура представляет собой алгоритм,
    состоящий из нескольких арифметических операций. Алгоритм подписи использует секретный ключ, а алгоритм проверки
    использует только открытый ключ.</p>
<p>Изучение Алгоритма Цифровой Подписи с Эллиптическими Кривыми начнем с рассмотрения конечных полей и эллиптических
    кривых <a href="litra.html#0">[1]</a>, <a href="litra.html#1">[2]</a>.</p>
<h3>6.6.1. Конечные поля</h3>
<p><span class="teorema">Поле – это множество <math><mi>F</mi></math> элементов любой природы, для которых определены две бинарные операции сложения и умножения, удовлетворяющие условиям:
<ol>
    <li>
        <math>
            <mo>&#8704;</mo>
            <mfenced open="" close="">
                <mi>a</mi>
                <mo>,</mo>
                <mi>b</mi>
                <mo>,</mo>
                <mi>c</mi>
            </mfenced>
            <mo>&#8712;</mo>
            <mi>F</mi>
        </math>
        имеет место ассоциативность сложения
        <math>
            <mrow>
                <mo>(</mo>
                <mi>a</mi>
                <mo>+</mo>
                <mi>b</mi>
                <mo>)</mo>
                <mo>+</mo>
                <mi>c</mi>
            </mrow>
            <mo>=</mo>
            <mrow>
                <mi>a</mi>
                <mo>+</mo>
                <mo>(</mo>
                <mi>b</mi>
                <mo>+</mo>
                <mi>c</mi>
                <mo>)</mo>
            </mrow>
        </math>
        ;
    </li>
    <li>существует элемент
        <math>
            <mi>0</mi>
        </math>
        , для которого
        <math>
            <mrow>
                <mi>a</mi>
                <mo>+</mo>
                <mi>0</mi>
            </mrow>
            <mo>=</mo>
            <mrow>
                <mi>0</mi>
                <mo>+</mo>
                <mi>a</mi>
            </mrow>
            <mo>=</mo>
            <mi>a</mi>
            <mo>,</mo>
            <mrow>
                <mi>a</mi>
                <mo>&#8712;</mo>
                <mi>F</mi>
            </mrow>
        </math>
        ;
    </li>
    <li>
        <math>
            <mrow>
                <mo>&#8704;</mo>
                <mi>a</mi>
                <mo>&#8712;</mo>
                <mi>F</mi>
        </math>
        существует элемент
        <math>
            <mrow>
                <mo>-</mo>
                <mi>a</mi>
            </mrow>
            <mo>&#8712;</mo>
            <mi>F</mi>
        </math>
        такой, что
        <math>
            <mi>a</mi>
            <mo>+</mo>
            <mrow>
                <mo>(</mo>
                <mo>-</mo>
                <mi>a</mi>
                <mo>)</mo>
            </mrow>
            <mo>=</mo>
            <mi>0</mi>
        </math>
        ;
    </li>
    <li>
        <math>
            <mo>&#8704;</mo>
            <mfenced open="" close="">
                <mi>a</mi>
                <mo>,</mo>
                <mi>b</mi>
            </mfenced>
            <mo>&#8712;</mo>
            <mi>F</mi>
        </math>
        имеет место коммутативность сложения
        <math>
            <mrow>
                <mi>a</mi>
                <mo>+</mo>
                <mi>b</mi>
            </mrow>
            <mo>=</mo>
            <mrow>
                <mi>b</mi>
                <mo>+</mo>
                <mi>a</mi>
            </mrow>
        </math>
        ;
    </li>
    <li>
        <math>
            <mo>&#8704;</mo>
            <mfenced open="" close="">
                <mi>a</mi>
                <mo>,</mo>
                <mi>b</mi>
                <mo>,</mo>
                <mi>c</mi>
            </mfenced>
            <mo>&#8712;</mo>
            <mi>F</mi>
        </math>
        имеет место ассоциативность умножения
        <math>
            <mrow>
                <mo>(</mo>
                <mi>a</mi>
                <mo>&#x2062;</mo>
                <mi>b</mi>
                <mo>)</mo>
                <mo>&#x2062;</mo>
                <mi>c</mi>
            </mrow>
            <mo>=</mo>
            <mrow>
                <mi>a</mi>
                <mo>&#x2062;</mo>
                <mo>(</mo>
                <mi>b</mi>
                <mo>&#x2062;</mo>
                <mi>c</mi>
                <mo>)</mo>
            </mrow>
        </math>
        ;
    </li>
    <li>в
        <math>
            <mi>F</mi>
        </math>
        существует элемент
        <math>
            <mi>1</mi>
        </math>
        , что
        <math>
            <mrow>
                <mo>&#8704;</mo>
                <mi>a</mi>
                <mo>&#8712;</mo>
                <mi>F</mi>
        </math>
        имеет место равенство
        <math>
            <mrow>
                <mi>1</mi>
                <mo>&#x2062;</mo>
                <mi>a</mi>
            </mrow>
            <mo>=</mo>
            <mrow>
                <mi>a</mi>
                <mo>&#x2062;</mo>
                <mi>1</mi>
            </mrow>
            <mo>=</mo>
            <mi>a</mi>
        </math>
        ;
    </li>
    <li>
        <math>
            <mrow>
                <mo>&#8704;</mo>
                <mi>a</mi>
                <mo>&#8712;</mo>
                <mi>F</mi>
                <mo>,</mo>
                <mrow>
                    <mi>a</mi>
                    <mo>&#8800;</mo>
                    <mn>0</mn>
                </mrow>
        </math>
        , существует обратный элемент
        <math>
            <msup>
                <mi>a</mi>
                <mrow>
                    <mo>-</mo>
                    <mn>1</mn>
                </mrow>
            </msup>
            <mo>&#8712;</mo>
            <mi>F</mi>
        </math>
        такой, что
        <math>
            <mi>a</mi>
            <mo>&#x2062;</mo>
            <msup>
                <mi>a</mi>
                <mrow>
                    <mo>-</mo>
                    <mn>1</mn>
                </mrow>
            </msup>
            <mo>=</mo>
            <mi>1</mi>
        </math>
        ;
    </li>
    <li>
        <math>
            <mo>&#8704;</mo>
            <mfenced open="" close="">
                <mi>a</mi>
                <mo>,</mo>
                <mi>b</mi>
            </mfenced>
            <mo>&#8712;</mo>
            <mi>F</mi>
        </math>
        имеет место коммутативность умножения
        <math>
            <mrow>
                <mi>a</mi>
                <mo>&#x2062;</mo>
                <mi>b</mi>
            </mrow>
            <mo>=</mo>
            <mrow>
                <mi>b</mi>
                <mo>&#x2062;</mo>
                <mi>a</mi>
            </mrow>
        </math>
        ;
    </li>
    <li>
        <math>
            <mo>&#8704;</mo>
            <mfenced open="" close="">
                <mi>a</mi>
                <mo>,</mo>
                <mi>b</mi>
                <mo>,</mo>
                <mi>c</mi>
            </mfenced>
            <mo>&#8712;</mo>
            <mi>F</mi>
        </math>
        имеет место дистрибутивность умножения относительно сложения:
        <math>
            <mrow>
                <mi>a</mi>
                <mo>&#x2062;</mo>
                <mo>(</mo>
                <mi>b</mi>
                <mo>+</mo>
                <mi>c</mi>
                <mo>)</mo>
            </mrow>
            <mo>=</mo>
            <mrow>
                <mi>a</mi>
                <mo>&#x2062;</mo>
                <mi>b</mi>
                <mo>+</mo>
                <mi>a</mi>
                <mo>&#x2062;</mo>
                <mi>c</mi>
            </mrow>
        </math>
        .
    </li>
</ol>
</span>
</p>
<p>Некоторые сведения о расчете остатка от целочисленного деления
    <math>
        <mo>mod</mo>
    </math>
    . Остаток от деления положительного целого числа
    <math>
        <mi>n</mi>
    </math>
    на положительное целое число
    <math>
        <mi>m</mi>
    </math>
    можно вычислить последовательным
    <math>
        <mi>k</mi>
    </math>
    раз вычитанием из
    <math>
        <mi>n</mi>
    </math>
    числа
    <math>
        <mi>m</mi>
    </math>
    до тех пор, пока разность
    <math>
        <mi>r</mi>
    </math>
    не окажется меньше
    <math>
        <mi>m</mi>
    </math>
    :
    <math display="inline">
        <mi>r</mi>
        <mo>=</mo>
        <mrow>
            <mi>n</mi>
            <mo>-</mo>
            <mrow>
                <mi>k</mi>
                <mo>&#x2061;</mo>
                <mi>m</mi>
            </mrow>
        </mrow>
        <mo>.</mo>
    </math>
    Остаток от деления отрицательного целого числа
    <math>
        <mo>-</mo>
        <mi>n</mi>
    </math>
    на положительное целое число
    <math>
        <mi>m</mi>
    </math>
    можно вычислить последовательным прибавлением к числу
    <math>
        <mo>-</mo>
        <mi>n</mi>
    </math>
    числа
    <math>
        <mi>m</mi>
    </math>
    до тех пор, пока сумма
    <math>
        <mi>r</mi>
    </math>
    не окажется неотрицательной и меньшей
    <math>
        <mi>m</mi>
    </math>
    :
    <math display="inline">
        <mi>r</mi>
        <mo>=</mo>
        <mrow>
            <mrow>
                <mo>-</mo>
                <mi>n</mi>
            </mrow>
            <mo>+</mo>
            <mrow>
                <mi>k</mi>
                <mo>&#x2061;</mo>
                <mi>m</mi>
            </mrow>
        </mrow>
    </math>
    .
</p>
<p>К примеру,
    <math>
        <mrow>
            <mn>27</mn>
            <mo>mod</mo>
            <mn>7</mn>
        </mrow>
        <mo>=</mo>
        <mrow>
            <mn>27</mn>
            <mo>-</mo>
            <mrow>
                <mn>3</mn>
                <mo>&#183;</mo>
                <mn>7</mn>
            </mrow>
            <mo>=</mo>
            <mn>6</mn>
        </mrow>
    </math>
    ,
    <math>
        <mrow>
            <mrow>
                <mo>-</mo>
                <mn>27</mn>
            </mrow>
            <mo>mod</mo>
            <mn>7</mn>
        </mrow>
        <mo>=</mo>
        <mrow>
            <mrow>
                <mo>-</mo>
                <mn>27</mn>
            </mrow>
            <mo>+</mo>
            <mrow>
                <mn>4</mn>
                <mo>&#183;</mo>
                <mn>7</mn>
            </mrow>
            <mo>=</mo>
            <mn>1</mn>
        </mrow>
    </math>
    .
</p>


<p>Построим поле
    <math>
        <msub>
            <mi>F</mi>
            <mi>p</mi>
        </msub>
    </math>
    , в котором операции сложения и умножения выполняются по модулю
    <math>
        <mi>p</mi>
    </math>
    , причем
    <math>
        <mi>p</mi>
    </math>
    - простое число, и количество элементов конечно и равно
    <math>
        <mi>p</mi>
    </math>
    . Результатом сложения (умножения) по модулю
    <math>
        <mi>p</mi>
    </math>
    будет остаток от деления на
    <math>
        <mi>p</mi>
    </math>
    суммы (произведения) операндов:
    <math>
        <mrow>
            <mo>(</mo>
            <mi>a</mi>
            <mo>+</mo>
            <mi>b</mi>
            <mo>)</mo>
        </mrow>
        <mrow>
            <mo>mod</mo>
            <mi>p</mi>
        </mrow>
        <mo>,</mo>
        <mrow>
            <mo>(</mo>
            <mi>a</mi>
            <mo>&#x2062;</mo>
            <mi>b</mi>
            <mo>)</mo>
        </mrow>
        <mrow>
            <mo>mod</mo>
            <mi>p</mi>
        </mrow>
    </math>
    . Элементами поля будут числа от 0 до
    <math>
        <mi>p</mi>
        <mo>-</mo>
        <mn>1</mn>
    </math>
    . Нулевым элементом будет число
    <math>
        <mn>0</mn>
    </math>
    , а единичным - число
    <math>
        <mn>1</mn>
    </math>
    .
</p>
<p>
    <math>
        <mrow>
            <mo>&#8704;</mo>
            <mi>a</mi>
            <mo>&#8712;</mo>
            <msub>
                <mi>F</mi>
                <mi>p</mi>
            </msub>
    </math>
    противоположным элементом будет
    <math>
        <mrow>
            <mo>-</mo>
            <mi>a</mi>
        </mrow>
        <mo>=</mo>
        <mrow>
            <mrow>
                <mo>(</mo>
                <mi>p</mi>
                <mo>-</mo>
                <mi>a</mi>
                <mo>)</mo>
            </mrow>
            <mo>mod</mo>
            <mi>p</mi>
        </mrow>
    </math>
    .
</p>
<p>Для ненулевого элемента
    <math>
        <mi>a</mi>
    </math>
    определим в качестве обратного элемента
    <math>
        <msup>
            <mi>a</mi>
            <mrow>
                <mo>-</mo>
                <mn>1</mn>
            </mrow>
        </msup>
    </math>
    такое число
    <math>
        <mi>b</mi>
    </math>
    , что
    <math>
        <mrow>
            <mrow>
                <mo>(</mo>
                <mi>a</mi>
                <mo>&#x2062;</mo>
                <mi>b</mi>
                <mo>)</mo>
            </mrow>
            <mo>mod</mo>
            <mi>p</mi>
        </mrow>
        <mo>=</mo>
        <mn>1</mn>
    </math>
    .
</p>
<p><span class="teorema">Для простого числа <math><mi>p</mi></math> справедливо утверждение: всякий ненулевой элемент <math><mi>a</mi><mo>&#8712;</mo><msub><mi>F</mi><mi>p</mi></msub></math> имеет единственный обратный элемент <math><msup><mi>a</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>&#8712;</mo><msub><mi>F</mi><mi>p</mi></msub></math>.</span>
</p>
<div class="examp">
    <p>Пример 6.5.1. Построим поле
        <math>
            <msub>
                <mi>F</mi>
                <mn>7</mn>
            </msub>
            <mo>=</mo>
            <mfenced open="{" close="}">
                <mn>0</mn>
                <mo>,</mo>
                <mn>1</mn>
                <mo>,</mo>
                <mn>2</mn>
                <mo>,</mo>
                <mn>3</mn>
                <mo>,</mo>
                <mn>4</mn>
                <mo>,</mo>
                <mn>5</mn>
                <mo>,</mo>
                <mn>6</mn>
            </mfenced>
        </math>
        .
    </p>
    <p>Очевидно, что
        <math>
            <msub>
                <mi>F</mi>
                <mn>7</mn>
            </msub>
        </math>
        будет замкнуто относительно операций сложения и умножения по модулю
        <math>
            <mn>7</mn>
        </math>
        .
    </p>
    <p>Противоположным элементом к элементу
        <math>
            <mn>1</mn>
        </math>
        будет
        <math>
            <mn>6</mn>
        </math>
        :
        <math>
            <mrow>
                <mrow>
                    <mo>(</mo>
                    <mn>1</mn>
                    <mo>+</mo>
                    <mn>6</mn>
                    <mo>)</mo>
                </mrow>
                <mo>mod</mo>
                <mn>7</mn>
            </mrow>
            <mo>=</mo>
            <mn>0</mn>
        </math>
        . Множество пар противоположных элементов:
        <math>
            <mfenced open="{" close="}">
                <mrow>
                    <mo>(</mo>
                    <mn>0</mn>
                    <mo>,</mo>
                    <mn>0</mn>
                    <mo>)</mo>
                </mrow>
                <mrow>
                    <mo>(</mo>
                    <mn>1</mn>
                    <mo>,</mo>
                    <mn>6</mn>
                    <mo>)</mo>
                </mrow>
                <mrow>
                    <mo>(</mo>
                    <mn>2</mn>
                    <mo>,</mo>
                    <mn>5</mn>
                    <mo>)</mo>
                </mrow>
                <mrow>
                    <mo>(</mo>
                    <mn>3</mn>
                    <mo>,</mo>
                    <mn>4</mn>
                    <mo>)</mo>
                </mrow>
            </mfenced>
        </math>
        .
    </p>
    <p>Для всех ненулевых элементов поля
        <math>
            <msub>
                <mi>F</mi>
                <mn>7</mn>
            </msub>
        </math>
        вычислим обратные элементы.Единичный элемент совпадает со своим обратным элементом. Обратным элементом для
        <math>
            <mn>2</mn>
        </math>
        будет
        <math>
            <mn>4</mn>
        </math>
        , так как
        <math>
            <mrow>
                <mo>(</mo>
                <mn>2</mn>
                <mo>&#183;</mo>
                <mn>4</mn>
                <mo>)</mo>
            </mrow>
            <mo>mod</mo>
            <mn>7</mn>
            <mo>=</mo>
            <mn>1</mn>
        </math>
        . Множество взаимно обратных элементов:
        <math>
            <mfenced open="{" close="}">
                <mrow>
                    <mo>(</mo>
                    <mn>1</mn>
                    <mo>,</mo>
                    <mn>1</mn>
                    <mo>)</mo>
                </mrow>
                <mrow>
                    <mo>(</mo>
                    <mn>2</mn>
                    <mo>,</mo>
                    <mn>4</mn>
                    <mo>)</mo>
                </mrow>
                <mrow>
                    <mo>(</mo>
                    <mn>3</mn>
                    <mo>,</mo>
                    <mn>5</mn>
                    <mo>)</mo>
                </mrow>
                <mrow>
                    <mo>(</mo>
                    <mn>6</mn>
                    <mo>,</mo>
                    <mn>6</mn>
                    <mo>)</mo>
                </mrow>
            </mfenced>
        </math>
        .
    </p>
</div>
<h3>6.6.2. Эллиптическая кривая над конечным полем</h3>
<p>Эллиптическая кривая, используемая биткойном, задается следующим уравнением:
    <a name="f6.6.1"></a>
<table class='formula'>
    <tr>
        <td class='formula'>
            <math display='block'>
                <mrow>
                    <msup>
                        <mi>y</mi>
                        <mn>2</mn>
                    </msup>
                    <mo>=</mo>
                    <mrow>
                        <msup>
                            <mi>x</mi>
                            <mn>3</mn>
                        </msup>
                        <mo>+</mo>
                        <mn>7</mn>
                    </mrow>
                </mrow>
                <mo>.</mo>
            </math>
        </td>
        <td class='nomer'>(6.6.1)</td>
    </tr>
</table>
</p>
<p>График эллиптической кривой 6.6.1 выглядит так:</p>
<table align='center'>
    <tr>
        <td>
            <svg height="480px" width="600px" xmlns:xlink=" http://www.w3.org/1999/xlink">
                <defs>
                    <g id="bes1">
                        <path d="M 200 50 C 190 65, 200 175, 75 175 Q 5 183, 5 300" stroke="#000000" stroke-width="1"
                              fill="none"/>
                    </g>
                </defs>
                <g transform="scale(0.8)">
                    <use xlink:href="#bes1" transform="translate(200,0)"/>
                    <use xlink:href="#bes1" transform="scale(1,-1) translate(200,-600)"/>
                    <line x1="145" y1="300" x2="450" y2="300" stroke="#000000" stroke-width="1" fill="none"/>
                    <line x1="300" y1="20" x2="300" y2="570" stroke="#000000" stroke-width="1" fill="none"/>
                    <line x1="150" y1="20" x2="150" y2="570" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="200" y1="20" x2="200" y2="570" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="250" y1="20" x2="250" y2="570" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="350" y1="20" x2="350" y2="570" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="400" y1="20" x2="400" y2="570" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="450" y1="20" x2="450" y2="570" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="250" x2="450" y2="250" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="200" x2="450" y2="200" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="150" x2="450" y2="150" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="100" x2="450" y2="100" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="50" x2="450" y2="50" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="350" x2="450" y2="350" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="400" x2="450" y2="400" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="450" x2="450" y2="450" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="500" x2="450" y2="500" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="550" x2="450" y2="550" stroke="#000000" stroke-width="0.5" fill="none"/>

                    <text x="285" y="315">0</text>
                    <text x="200" y="315">-1.91</text>
                    <text x="285" y="188">2.64</text>
                    <text x="285" y="445">-2.64</text>
                    <text x="160" y="590">Рис. 6.6.1. Эллиптическая кривая</text>
                </g>
            </svg>
        </td>
    </tr>
</table>
<p>Эллиптические кривые имеют некоторые полезные свойства. Например, прямая, не параллельная оси ординат и пересекающая
    кривую в двух точках, всегда будет пересекать ее и в третьей точке, лежащей на кривой. Если прямая, не параллельная
    оси ординат, является касательной к эллиптической кривой в одной из точек, то она обязательно пересекает ее еще
    ровно в одной точке. В случае параллельности к оси ординат касательной к эллиптической кривой или прямой,
    пересекающей эллиптическую кривую в двух точках, будем считать, что они пересекают эллиптическую кривую в бесконечно
    удаленной точке
    <math>
        <mi>O</mi>
        <mo>&#x2061;</mo>
        <mfenced separators=";">
            <mi>x</mi>
            <mi>&#8734;</mi>
        </mfenced>
    </math>
    .
</p>
<p>Используем эти свойства для определения операций сложения и удвоения точек эллиптической кривой.</p>
<p>Для сложения точек
    <math>
        <mi>P</mi>
    </math>
    и
    <math>
        <mi>Q</mi>
    </math>
    проведем через эти точки прямую, которая, по свойствам эллиптических кривых, пересечет кривую в некоторой третьей
    точке
    <math>
        <mi>R'</mi>
    </math>
    . Затем мы находим точку
    <math>
        <mi>R</mi>
    </math>
    на кривой, симметричную точке
    <math>
        <mi>R'</mi>
    </math>
    относительно оси
    <math>
        <mi>X</mi>
    </math>
    . Именно эта точка
    <math>
        <mi>R</mi>
    </math>
    и будет считаться суммой
    <math>
        <mi>P</mi>
        <mo>+</mo>
        <mi>Q</mi>
    </math>
    (см. рис. 6.5.2).
</p>
<table align='center'>
    <tr>
        <td>
            <svg height="480px" width="600px" xmlns:xlink=" http://www.w3.org/1999/xlink">
                <defs>
                    <g id="bes1">
                        <path d="M 200 50 C 190 65, 200 175, 75 175 Q 5 183, 5 300" stroke="#000000" stroke-width="1"
                              fill="none"/>
                    </g>
                </defs>
                <g transform="scale(0.8)">
                    <use xlink:href="#bes1" transform="translate(200,0)"/>
                    <use xlink:href="#bes1" transform="scale(1,-1) translate(200,-600)"/>
                    <line x1="145" y1="300" x2="450" y2="300" stroke="#000000" stroke-width="1" fill="none"/>
                    <line x1="300" y1="20" x2="300" y2="570" stroke="#000000" stroke-width="1" fill="none"/>
                    <line x1="150" y1="20" x2="150" y2="570" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="200" y1="20" x2="200" y2="570" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="250" y1="20" x2="250" y2="570" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="350" y1="20" x2="350" y2="570" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="400" y1="20" x2="400" y2="570" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="450" y1="20" x2="450" y2="570" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="250" x2="450" y2="250" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="200" x2="450" y2="200" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="150" x2="450" y2="150" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="100" x2="450" y2="100" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="50" x2="450" y2="50" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="350" x2="450" y2="350" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="400" x2="450" y2="400" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="450" x2="450" y2="450" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="500" x2="450" y2="500" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="550" x2="450" y2="550" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="150" y1="270" x2="450" y2="60" stroke="green" stroke-width="1" fill="none"/>
                    <line x1="387" y1="103" x2="387" y2="500" stroke="blue" stroke-width="1" fill="none"
                          stroke-dasharray="5"/>
                    <text x="285" y="315">0</text>
                    <text x="200" y="219">P</text>
                    <text x="285" y="188">Q</text>
                    <text x="375" y="513">R</text>
                    <text x="372" y="103">R'</text>
                    <text x="150" y="590">Рис. 6.6.2. Сложение точек P и Q</text>
                </g>
            </svg>
        </td>
    </tr>
</table>
<p>Запишем уравнение прямой PQ:
    <math display='inline'>
        <mrow>
            <mi>y</mi>
            <mo>=</mo>
            <mrow>
                <msub>
                    <mi>y</mi>
                    <mn>1</mn>
                </msub>
                <mo>+</mo>
                <mi>&#x03bb;</mi>
                <mo>(</mo>
                <mi>x</mi>
                <mo>-</mo>
                <msub>
                    <mi>x</mi>
                    <mn>1</mn>
                </msub>
                <mo>)</mo>
            </mrow>
        </mrow>
    </math>
    с угловым коэффициентом
    <a name="f6.5.2"></a>
<table class='formula'>
    <tr>
        <td class='formula'>
            <math display='block'>
                <mrow>
                    <mi>&#x03bb;</mi>
                    <mo>=</mo>
                    <mfrac>
                        <mrow>
                            <msub>
                                <mi>y</mi>
                                <mn>2</mn>
                            </msub>
                            <mo>-</mo>
                            <msub>
                                <mi>y</mi>
                                <mn>1</mn>
                            </msub>
                        </mrow>
                        <mrow>
                            <msub>
                                <mi>x</mi>
                                <mn>2</mn>
                            </msub>
                            <mo>-</mo>
                            <msub>
                                <mi>x</mi>
                                <mn>1</mn>
                            </msub>
                        </mrow>
                    </mfrac>
                </mrow>
            </math>
        </td>
        <td class='nomer'>(6.6.2)</td>
    </tr>
</table>
</p>
<p>Координаты точки пересечения эллиптической кривой и прямой PQ описываются системой уравнений:
    <math display='block'>
        <mrow>
            <mo>{</mo>
            <mtable>
                <mtr>
                    <mtd>
                        <mrow>
                            <mi>y</mi>
                            <mo>=</mo>
                            <mrow>
                                <msub>
                                    <mi>y</mi>
                                    <mn>1</mn>
                                </msub>
                                <mo>+</mo>
                                <mi>&#x03bb;</mi>
                                <mo>(</mo>
                                <mi>x</mi>
                                <mo>-</mo>
                                <msub>
                                    <mi>x</mi>
                                    <mn>1</mn>
                                </msub>
                                <mo>)</mo>
                            </mrow>
                        </mrow>
                        <mo>,</mo>
                    </mtd>
                </mtr>
                <mtr>
                    <mtd>
                        <msup>
                            <mi>y</mi>
                            <mn>2</mn>
                        </msup>
                        <mo>=</mo>
                        <mrow>
                            <msup>
                                <mi>x</mi>
                                <mn>3</mn>
                            </msup>
                            <mo>+</mo>
                            <mn>7</mn>
                        </mrow>
                        <mo>.</mo>
                    </mtd>
                </mtr>
            </mtable>
        </mrow>
    </math>
</p>
<p>Из предыдущей системы уравнений получим кубическое уравнение:
    <math display='block'>
        <msup>
            <mrow>
                <mrow>
                    <mo>(</mo>
                    <mrow>
                        <msub>
                            <mi>y</mi>
                            <mn>1</mn>
                        </msub>
                        <mo>+</mo>
                        <mi>&#x03bb;</mi>
                        <mo>(</mo>
                        <mi>x</mi>
                        <mo>-</mo>
                        <msub>
                            <mi>x</mi>
                            <mn>1</mn>
                        </msub>
                        <mo>)</mo>
                    </mrow>
                </mrow>
                <mo>)</mo>
            </mrow>
            <mn>2</mo>
        </msup>
        <mo>=</mo>
        <mrow>
            <msup>
                <mi>x</mi>
                <mn>3</mn>
            </msup>
            <mo>+</mo>
            <mn>7</mn>
        </mrow>
        <mo>.</mo>
    </math>
</p>
<p>Преобразуем последнее уравнение к следующему виду:
    <math display='block'>
        <msup>
            <mi>x</mi>
            <mn>3</mn>
        </msup>
        <mo>-</mo>
        <msup>
            <mi>&#x03bb;</mi>
            <mn>2</mn>
        </msup>
        <mo>&#x2062;</mo>
        <msup>
            <mi>x</mi>
            <mn>2</mn>
        </msup>
        <mo>+</mo>
        <mi>&#x2026;</mi>
    </math>
</p>
<p>Согласно теореме Виетта, сумма корней кубического уравнения равна коэффициенту при
    <math display='inline'>
        <msup>
            <mi>x</mi>
            <mn>2</mn>
        </msup>
    </math>
    , взятому с противоположным знаком:
    <math display='block'>
        <mrow>
            <msub>
                <mi>x</mi>
                <mn>1</mn>
            </msub>
            <mo>+</mo>
            <msub>
                <mi>x</mi>
                <mn>2</mn>
            </msub>
            <mo>+</mo>
            <msub>
                <mi>x</mi>
                <mn>3</mn>
            </msub>
        </mrow>
        <mo>=</mo>
        <msup>
            <mi>&#x03bb;</mi>
            <mn>2</mn>
        </msup>
        <mo>.</mo>
    </math>
</p>
<p>Следовательно,
    <math display='block'>
        <msub>
            <mi>x</mi>
            <mn>3</mn>
        </msub>
        <mo>=</mo>
        <mrow>
            <msup>
                <mi>&#x03bb;</mi>
                <mn>2</mn>
            </msup>
            <mo>-</mo>
            <msub>
                <mi>x</mi>
                <mn>1</mn>
            </msub>
            <mo>-</mo>
            <msub>
                <mi>x</mi>
                <mn>2</mn>
            </msub>
        </mrow>
        <mo>.</mo>
    </math>
</p>
<p>В уравнении прямой PQ заменим x на
    <math display='inline'>
        <msub>
            <mi>x</mi>
            <mn>3</mn>
        </msub>
    </math>
    и найдем
    <math display='inline'>
        <msub>
            <mi>y</mi>
            <mn>3</mn>
        </msub>
    </math>
    :
    <math display='block'>
        <mrow>
            <msub>
                <mi>y</mi>
                <mn>3</mn>
            </msub>
            <mo>=</mo>
            <mrow>
                <msub>
                    <mi>y</mi>
                    <mn>1</mn>
                </msub>
                <mo>+</mo>
                <mi>&#x03bb;</mi>
                <mo>(</mo>
                <msub>
                    <mi>x</mi>
                    <mn>3</mn>
                </msub>
                <mo>-</mo>
                <msub>
                    <mi>x</mi>
                    <mn>1</mn>
                </msub>
                <mo>)</mo>
            </mrow>
        </mrow>
        <mo>.</mo>
    </math>
</p>
<p>Тогда сумма точек P и Q (точка R) будет иметь следующие координаты:
    <a name="f6.6.3"></a>
<table class='formula'>
    <tr>
        <td class='formula'>
            <math display='block'>
                <mtable>
                    <mtr>
                        <mtd>
                            <msub>
                                <mi>R</mi>
                                <mi>x</mi>
                            </msub>
                            <mo>=</mo>
                            <mrow>
                                <msup>
                                    <mi>&#x03bb;</mi>
                                    <mn>2</mn>
                                </msup>
                                <mo>-</mo>
                                <msub>
                                    <mi>x</mi>
                                    <mn>1</mn>
                                </msub>
                                <mo>-</mo>
                                <msub>
                                    <mi>x</mi>
                                    <mn>2</mn>
                                </msub>
                            </mrow>
                            <mo>,</mo>
                        </mtd>
                    </mtr>
                    <mtr>
                        <mtd>
                            <mrow>
                                <msub>
                                    <mi>R</mi>
                                    <mi>y</mi>
                                </msub>
                                <mo>=</mo>
                                <mrow>
                                    <mo>-</mo>
                                    <msub>
                                        <mi>y</mi>
                                        <mn>1</mn>
                                    </msub>
                                    <mo>-</mo>
                                    <mi>&#x03bb;</mi>
                                    <mo>(</mo>
                                    <msub>
                                        <mi>R</mi>
                                        <mi>x</mi>
                                    </msub>
                                    <mo>-</mo>
                                    <msub>
                                        <mi>x</mi>
                                        <mn>1</mn>
                                    </msub>
                                    <mo>)</mo>
                                </mrow>
                            </mrow>
                            <mo>.</mo>
                        </mtd>
                    </mtr>
                </mtable>
            </math>
        </td>
        <td class='nomer'>(6.6.3)</td>
    </tr>
</table>
</p>
<p>При удвоении мы проводим прямую, касательную к данной эллиптической кривой в точке P, которая, согласно свойствам
    кривой, должна пересекать ее еще в одной точке R‘. Точка R, симметричная R‘ относительно оси X, и будет считаться
    точкой удвоения P. На графике это выглядит следующим образом:</p>
<table align='center'>
    <tr>
        <td>
            <svg height="480px" width="600px" xmlns:xlink=" http://www.w3.org/1999/xlink">
                <defs>
                    <g id="bes1">
                        <path d="M 200 50 C 190 65, 200 175, 75 175 Q 5 183, 5 300" stroke="#000000" stroke-width="1"
                              fill="none"/>
                    </g>
                </defs>
                <g transform="scale(0.8)">
                    <use xlink:href="#bes1" transform="translate(200,0)"/>
                    <use xlink:href="#bes1" transform="scale(1,-1) translate(200,-600)"/>
                    <line x1="145" y1="300" x2="450" y2="300" stroke="#000000" stroke-width="1" fill="none"/>
                    <line x1="300" y1="20" x2="300" y2="570" stroke="#000000" stroke-width="1" fill="none"/>
                    <line x1="150" y1="20" x2="150" y2="570" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="200" y1="20" x2="200" y2="570" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="250" y1="20" x2="250" y2="570" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="350" y1="20" x2="350" y2="570" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="400" y1="20" x2="400" y2="570" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="450" y1="20" x2="450" y2="570" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="250" x2="450" y2="250" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="200" x2="450" y2="200" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="150" x2="450" y2="150" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="100" x2="450" y2="100" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="50" x2="450" y2="50" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="350" x2="450" y2="350" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="400" x2="450" y2="400" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="450" x2="450" y2="450" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="500" x2="450" y2="500" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="145" y1="550" x2="450" y2="550" stroke="#000000" stroke-width="0.5" fill="none"/>
                    <line x1="150" y1="251" x2="450" y2="40" stroke="green" stroke-width="1" fill="none"/>
                    <line x1="394" y1="85" x2="394" y2="517" stroke="blue" stroke-width="1" fill="none"
                          stroke-dasharray="5"/>
                    <text x="285" y="315">0</text>
                    <text x="245" y="200">P</text>
                    <text x="375" y="521">R</text>
                    <text x="373" y="83">R'</text>
                    <text x="150" y="590">Рис. 6.6.3. Удвоение точки P</text>
                </g>
            </svg>
        </td>
    </tr>
</table>
<p>Получим формулы удвоения точки P. Угловой коэффициент касательной к эллиптической кривой в точке P равен значению
    производной от y в точке P:
    <a name="f6.6.4"></a>
<table class='formula'>
    <tr>
        <td class='formula'>
            <math display='block'>
                <mtable>
                    <mtr>
                        <mtd>
                            <mrow>
                                <mn>2</mn>
                                <mo>&#x2062;</mo>
                                <mi>y</mi>
                            </mrow>
                            <mo>&#x2062;</mo>
                            <mfrac>
                                <mrow>
                                    <mo> &#x2146;</mo>
                                    <mi>y</mi>
                                </mrow>
                                <mrow>
                                    <mo> &#x2146;</mo>
                                    <mi>x</mi>
                                </mrow>
                            </mfrac>
                            <mo>=</mo>
                            <mrow>
                                <mn>3</mn>
                                <mo>&#x2062;</mo>
                                <msup>
                                    <mi>x</mi>
                                    <mn>2</mn>
                                </msup>
                            </mrow>
                            <mo>,</mo>
                        </mtd>
                    </mtr>
                    <mtr>
                        <mtd>
                            <mrow>
                                <mi>&#x03bb;</mi>
                                <mo>=</mo>
                            </mrow>
                            <mfrac>
                                <mrow>
                                    <mn>3</mn>
                                    <mo>&#x2062;</mo>
                                    <msubsup>
                                        <mi>x</mi>
                                        <mn>1</mn>
                                        <mn>2</mn>
                                    </msubsup>
                                </mrow>
                                <mrow>
                                    <mn>2</mn>
                                    <msub>
                                        <mi>y</mi>
                                        <mn>1</mn>
                                    </msub>
                                </mrow>
                            </mfrac>
                            <mo>.</mo>
                        </mtd>
                    </mtr>
                </mtable>
            </math>
        </td>
        <td class='nomer'>(6.6.4)</td>
    </tr>
</table>
</p>
<p>Координаты удвоенной точки
    <math>
        <mi>R</mi>
        <mo>=</mo>
        <mrow>
            <mn>2</mn>
            <mo>&#x2062;</mo>
            <mi>P</mi>
        </mrow>
    </math>
    такие:
    <a name="f6.6.5"></a>
<table class='formula'>
    <tr>
        <td class='formula'>
            <math display='block'>
                <mtable>
                    <mtr>
                        <mtd>
                            <msub>
                                <mi>R</mi>
                                <mi>x</mi>
                            </msub>
                            <mo>=</mo>
                            <mrow>
                                <msup>
                                    <mi>&#x03bb;</mi>
                                    <mn>2</mn>
                                </msup>
                                <mo>-</mo>
                                <mrow>
                                    <mn>2</mn>
                                    <mo>&#x2062;</mo>
                                    <msub>
                                        <mi>x</mi>
                                        <mn>1</mn>
                                    </msub>
                                </mrow>
                            </mrow>
                            <mo>,</mo>
                        </mtd>
                    </mtr>
                    <mtr>
                        <mtd>
                            <mrow>
                                <msub>
                                    <mi>R</mi>
                                    <mi>y</mi>
                                </msub>
                                <mo>=</mo>
                                <mrow>
                                    <mo>-</mo>
                                    <msub>
                                        <mi>y</mi>
                                        <mn>1</mn>
                                    </msub>
                                    <mo>-</mo>
                                    <mi>&#x03bb;</mi>
                                    <mo>(</mo>
                                    <msub>
                                        <mi>R</mi>
                                        <mi>x</mi>
                                    </msub>
                                    <mo>-</mo>
                                    <msub>
                                        <mi>x</mi>
                                        <mn>1</mn>
                                    </msub>
                                    <mo>)</mo>
                                </mrow>
                            </mrow>
                            <mo>.</mo>
                        </mtd>
                    </mtr>
                </mtable>
            </math>
        </td>
        <td class='nomer'>(6.6.5)</td>
    </tr>
</table>
</p>
<p>Эти две операции можно использовать, чтобы определить операцию скалярного умножения,
    <math>
        <mi>R</mi>
        <mo>=</mo>
        <mi>k</mi>
        <mo>&#183;</mo>
        <mi>P</mi>
    </math>
    , определяемую как последовательность операций удвоения и сложения точек: число
    <math>
        <mi>k</mi>
    </math>
    следует представить в двоичной системе счисления
    <math>
        <mi>k</mi>
        <mo>=</mo>
        <mfenced open="" close="" separators="">
            <msub>
                <mi>k</mi>
                <mi>t</mi>
            </msub>
            <msub>
                <mi>k</mi>
                <mrow>
                    <mi>t</mi>
                    <mo>-</mo>
                    <mn>1</mn>
                </mrow>
            </msub>
            <mi>&#8230;</mi>
            <msub>
                <mi>k</mi>
                <mn>0</mn>
            </msub>
        </mfenced>
    </math>
    , затем вычислить все точки
    <math>
        <mrow>
            <mn>2</mn>
            <mo>&#x2062;</mo>
            <mi>P</mi>
        </mrow>
        <mo>,</mo>
        <mrow>
            <mn>4</mn>
            <mo>&#x2062;</mo>
            <mi>P</mi>
        </mrow>
        <mo>,</mo>
        <mi>&#8230;</mi>
        <mo>,</mo>
        <mrow>
            <msup>
                <mn>2</mn>
                <mi>t</mi>
            </msup>
            <mo>&#x2062;</mo>
            <mi>P</mi>
        </mrow>
    </math>
    , и, наконец, посчитать сумму тех точек
    <math>
        <mrow>
            <msup>
                <mn>2</mn>
                <mi>i</mi>
            </msup>
            <mo>&#x2062;</mo>
            <mi>P</mi>
        </mrow>
    </math>
    , для которых
    <math>
        <msub>
            <mi>k</mi>
            <mi>i</mi>
        </msub>
        <mo>=</mo>
        <mn>1</mn>
    </math>
    .
</p>
<div class="examp">
    <p>Пример 6.5.2. Для вычисления точки
        <math>
            <mn>13</mn>
            <mo>&#x2062;</mo>
            <mi>P</mi>
        </math>
        множитель представим в двоичной системе счисления:
        <math>
            <msub>
                <mn>13</mn>
                <mn>10
                </mn<>
            </msub>
            <mo>=</mo>
            <msub>
                <mn>1101</mn>
                <mn>2
                </mn<>
            </msub>
        </math>
        . Следовательно,
        <math>
            <mrow>
                <mn>13</mn>
                <mo>&#x2062;</mo>
                <mi>P</mi>
            </mrow>
            <mo>=</mo>
            <mrow>
                <mrow>
                    <mn>8</mn>
                    <mo>&#x2062;</mo>
                    <mi>P</mi>
                </mrow>
                <mo>+</mo>
                <mrow>
                    <mn>4</mn>
                    <mo>&#x2062;</mo>
                    <mi>P</mi>
                </mrow>
                <mo>+</mo>
                <mi>P</mi>
            </mrow>
        </math>
        .
    </p>
</div>
<p><span class="teorema">Эллиптической кривой над полем <math><msub><mi>F</mi><mi>p</mi></msub></math> называется множество точек, координаты которых принадлежат полю <math><msub><mi>F</mi><mi>p</mi></msub></math> и удовлетворяют уравнению эллиптической кривой по модулю <math><mi>p</mi></math>.</span>
</p>

<p><span class="teorema">Группой называется множество <math><mi>G</mi></math> элементов любой природы, для которых определена бинарная алгебраическая операция <math><mo>o</mo></math>, удовлетворяющая следующим условиям:
<ol>
    <li>
        <math>
            <mo>&#8704;</mo>
            <mfenced open="" close="">
                <mi>a</mi>
                <mo>,</mo>
                <mi>b</mi>
            </mfenced>
            <mo>&#8712;</mo>
            <mi>G</mi>
        </math>
        существует элемент
        <math>
            <mi>c</mi>
            <mo>&#8712;</mo>
            <mi>G</mi>
            <mo>,</mo>
            <mi>c</mi>
            <mo>=</mo>
            <mi>a</mi>
            <mo>o</mo>
            <mi>b</mi>
        </math>
        (замкнутость операции);
    </li>
    <li>
        <math>
            <mo>&#8704;</mo>
            <mfenced open="" close="">
                <mi>a</mi>
                <mo>,</mo>
                <mi>b</mi>
                <mo>,</mo>
                <mi>c</mi>
            </mfenced>
            <mo>&#8712;</mo>
            <mi>G</mi>
        </math>
        имеет место ассоциативность операции
        <math>
            <mo>o</mo>
        </math>
        :
        <math>
            <mrow>
                <mo>(</mo>
                <mi>a</mi>
                <mo>o</mo>
                <mi>b</mi>
                <mo>)</mo>
                <mo>o</mo>
                <mi>c</mi>
            </mrow>
            <mo>=</mo>
            <mrow>
                <mi>a</mi>
                <mo>o</mo>
                <mo>(</mo>
                <mi>b</mi>
                <mo>o</mo>
                <mi>c</mi>
                <mo>)</mo>
            </mrow>
        </math>
        ;
    </li>
    <li>существует нейтральный элемент
        <math>
            <mi>e</mi>
            <mo>&#8712;</mo>
            <mi>G</mi>
        </math>
        , для которого
        <math>
            <mrow>
                <mo>&#8704;</mo>
                <mi>a</mi>
                <mo>&#8712;</mo>
                <mi>G</mi>
            </mrow>
        </math>
        имеет место равенство
        <math>
            <mrow>
                <mi>a</mi>
                <mo>o</mo>
                <mi>e</mi>
            </mrow>
            <mo>=</mo>
            <mrow>
                <mi>e</mi>
                <mo>o</mo>
                <mi>a</mi>
            </mrow>
            <mo>=</mo>
            <mi>a</mi>
        </math>
        ;
    </li>
    <li>
        <math>
            <mrow>
                <mo>&#8704;</mo>
                <mi>a</mi>
                <mo>&#8712;</mo>
                <mi>G</mi>
        </math>
        существует обратный элемент
        <math>
            <msup>
                <mi>a</mi>
                <mi>'</mi>
            </msup>
            <mo>&#8712;</mo>
            <mi>G</mi>
        </math>
        такой, что
        <math>
            <mi>a</mi>
            <mo>&#x2062;</mo>
            <msup>
                <mi>a</mi>
                <mi>'</mi>
            </msup>
            <mo>=</mo>
            <mi>e</mi>
        </math>
        ;
    </li>

</ol>
</span>
</p>
<p>Если
    <math>
        <mo>&#8704;</mo>
        <mfenced open="" close="">
            <mi>a</mi>
            <mo>,</mo>
            <mi>b</mi>
        </mfenced>
        <mo>&#8712;</mo>
        <mi>G</mi>
    </math>
    имеет место свойство коммутативности операции
    <math>
        <mo>o</mo>
    </math>
    :
    <math>
        <mrow>
            <mi>a</mi>
            <mo>o</mo>
            <mi>b</mi>
        </mrow>
        <mo>=</mo>
        <mrow>
            <mi>b</mi>
            <mo>o</mo>
            <mi>a</mi>
        </mrow>
    </math>
    , то группа
    <math>
        <mi>G</mi>
    </math>
    называется коммутативной или абелевой.
</p>
<p><span class="teorema">Группа, в которой групповой операцией является умножение, называется мультипликативной.</span>
    В мультипликативной группе нейтральный элемент называют единичным, а
    <math>
        <mo>&#8704;</mo>
        <mi>a</mi>
        <mo>&#8712;</mo>
        <mi>G</mi>
    </math>
    обратный элемент обозначается как
    <math>
        <msup>
            <mi>a</mi>
            <mrow>
                <mo>-</mo>
                <mn>1</mn>
            </mrow>
    </math>
    .
</p>
<p><span class="teorema">Группа, в которой групповой операцией является сложение, называется аддитивной.</span> В
    аддитивной группе нейтральный элемент называют нулевым, а
    <math>
        <mo>&#8704;</mo>
        <mi>a</mi>
        <mo>&#8712;</mo>
        <mi>G</mi>
    </math>
    обратный элемент обозначается как
    <math>
        <mo>-</mo>
        <mi>a</mi>
    </math>
    .
</p>
<p>Дополним эллиптическую кривую над конечным полем
    <math>
        <msub>
            <mi>F</mi>
            <mi>p</mi>
        </msub>
    </math>
    бесконечно удаленной точкой
    <math>
        <mi>O</mi>
        <mo>&#x2061;</mo>
        <mfenced separators=";">
            <mi>x</mi>
            <mi>&#8734;</mi>
        </mfenced>
    </math>
    , для которой положим
    <math>
        <mi>P</mi>
        <mo>+</mo>
        <mrow>
            <mo>(</mo>
            <mo>-</mo>
            <mi>P</mi>
            <mo>)</mo>
        </mrow>
        <mo>=</mo>
        <mi>O</mi>
        <mo>&#x2061;</mo>
        <mfenced separators=";">
            <mi>x</mi>
            <mi>&#8734;</mi>
        </mfenced>
    </math>
    .
</p>
<p><span class="teorema">Согласно теореме Пуанкаре, эллиптическая кривая над конечным полем <math><msub><mi>F</mi><mi>p</mi></msub></math>, дополненная бесконечно удаленной точкой <math><mi>O</mi><mo>&#x2061;</mo><mfenced
        separators=";"><mi>x</mi><mi>&#8734;</mi></mfenced></math>, образует коммутативную группу <math><msub><mi>GF</mi><mi>p</mi></msub></math> относительно операции сложения точек.</span>
</p>
<p><span class="teorema"><a id='por_grupp'></a>Количество точек в группе <math><msub><mi>GF</mi><mi>p</mi></msub></math> называется его порядком.</span>
</p>
<p>Заметим, что для достаточно большого модуля p задача вычисления порядка группы путем перебора всех возможных значений
    является практически невыполнимой. Для вычисления порядка группы используют алгоритм Шуфа.</p>
<div class="examp">
    <p>Пример 6.6.3. В качестве примера вычислим эллиптическую кривую
        <math display='inline'>
            <mrow>
                <msup>
                    <mi>y</mi>
                    <mn>2</mn>
                </msup>
                <mo>=</mo>
                <mrow>
                    <msup>
                        <mi>x</mi>
                        <mn>3</mn>
                    </msup>
                    <mo>+</mo>
                    <mn>7</mn>
                </mrow>
            </mrow>
        </math>
        в контексте конечного поля
        <math>
            <msub>
                <mi>F</mi>
                <mn>11</mn>
            </msub>
        </math>
        .
    </p>
    <p>Вычислим левую часть уравнения
        <math display='inline'>
            <mrow>
                <msup>
                    <mi>y</mi>
                    <mn>2</mn>
                </msup>
                <mo>=</mo>
                <mrow>
                    <msup>
                        <mi>x</mi>
                        <mn>3</mn>
                    </msup>
                    <mo>+</mo>
                    <mn>7</mn>
                </mrow>
            </mrow>
            <mo>(</mo>
            <mo>mod</mo>
            <mn>11</mn>
            <mo>)</mo>
        </math>
    </p>
    <table border="1">
        <tr>
            <td>y</td>
            <td>0</td>
            <td>1</td>
            <td>2</td>
            <td>3</td>
            <td>4</td>
            <td>5</td>
            <td>6</td>
            <td>7</td>
            <td>8</td>
            <td>9</td>
            <td>10</td>
        </tr>
        <tr>
            <td>
                <math>
                    <msup>
                        <mi>y</mi>
                        <mn>2</mn>
                    </msup>
                </math>
            </td>
            <td>0</td>
            <td>1</td>
            <td>4</td>
            <td>9</td>
            <td>16</td>
            <td>25</td>
            <td>36</td>
            <td>49</td>
            <td>64</td>
            <td>81</td>
            <td>100</td>
        </tr>
        <tr>
            <td>
                <math>
                    <mrow>
                        <msup>
                            <mi>y</mi>
                            <mn>2</mn>
                        </msup>
                        <mo>mod</mo>
                        <mn>11</mn>
                    </mrow>
                </math>
            </td>
            <td>0</td>
            <td>1</td>
            <td>4</td>
            <td>9</td>
            <td>5</td>
            <td>3</td>
            <td>3</td>
            <td>5</td>
            <td>9</td>
            <td>4</td>
            <td>1</td>
        </tr>
    </table>
    <p>Аналогично вычислим правую часть уравнения:</p>
    <table border="1">
        <tr>
            <td>
                <math>
                    <mi>x</mi>
                </math>
            </td>
            <td>0</td>
            <td>1</td>
            <td>2</td>
            <td>3</td>
            <td>4</td>
            <td>5</td>
            <td>6</td>
            <td>7</td>
            <td>8</td>
            <td>9</td>
            <td>10</td>
        </tr>
        <tr>
            <td>
                <math>
                    <msup>
                        <mi>x</mi>
                        <mn>3</mn>
                    </msup>
                    <mo>+</mo>
                    <mn>7</mn>
                </math>
            </td>
            <td>7</td>
            <td>8</td>
            <td>15</td>
            <td>34</td>
            <td>71</td>
            <td>132</td>
            <td>223</td>
            <td>350</td>
            <td>519</td>
            <td>736</td>
            <td>1007</td>
        </tr>
        <tr>
            <td>
                <math>
                    <mrow>
                        <mo>(</mo>
                        <msup>
                            <mi>x</mi>
                            <mn>3</mn>
                        </msup>
                        <mo>+</mo>
                        <mn>7</mn>
                        <mo>)</mo>
                    </mrow>
                    <mo>mod</mo>
                    <mn>11</mn>
                </math>
            </td>
            <td>7</td>
            <td>8</td>
            <td>4</td>
            <td>1</td>
            <td>5</td>
            <td>0</td>
            <td>3</td>
            <td>9</td>
            <td>2</td>
            <td>10</td>
            <td>6</td>
        </tr>
    </table>
    <p>Сопоставляя левую часть уравнения с правой частью, найдем эллиптическую кривую над конечным полем
        <math>
            <msub>
                <mi>F</mi>
                <mn>11</mn>
            </msub>
        </math>
        как следующее множество точек:
        <math>
            <mo>{</mo>
            <mrow>
                <mo>(</mo>
                <mn>2</mn>
                <mo>,</mo>
                <mn>2</mn>
                <mo>)</mo>
            </mrow>
            <mo>,</mo>
            <mrow>
                <mo>(</mo>
                <mn>2</mn>
                <mo>,</mo>
                <mn>9</mn>
                <mo>)</mo>
            </mrow>
            <mo>,</mo>
            <mrow>
                <mo>(</mo>
                <mn>3</mn>
                <mo>,</mo>
                <mn>1</mn>
                <mo>)</mo>
            </mrow>
            <mo>,</mo>
            <mrow>
                <mo>(</mo>
                <mn>3</mn>
                <mo>,</mo>
                <mn>10</mn>
                <mo>)</mo>
            </mrow>
            <mo>,</mo>
            <mrow>
                <mo>(</mo>
                <mn>4</mn>
                <mo>,</mo>
                <mn>4</mn>
                <mo>)</mo>
            </mrow>
            <mo>,</mo>
            <mrow>
                <mo>(</mo>
                <mn>4</mn>
                <mo>,</mo>
                <mn>7</mn>
                <mo>)</mo>
            </mrow>
            <mo>,</mo>
            <mrow>
                <mo>(</mo>
                <mn>5</mn>
                <mo>,</mo>
                <mn>0</mn>
                <mo>)</mo>
            </mrow>
            <mo>,</mo>
            <mrow>
                <mo>(</mo>
                <mn>6</mn>
                <mo>,</mo>
                <mn>5</mn>
                <mo>)</mo>
            </mrow>
            <mo>,</mo>
            <mrow>
                <mo>(</mo>
                <mn>6</mn>
                <mo>,</mo>
                <mn>6</mn>
                <mo>)</mo>
            </mrow>
            <mo>,</mo>
            <mrow>
                <mo>(</mo>
                <mn>7</mn>
                <mo>,</mo>
                <mn>3</mn>
                <mo>)</mo>
            </mrow>
            <mo>,</mo>
            <mrow>
                <mo>(</mo>
                <mn>7</mn>
                <mo>,</mo>
                <mn>8</mn>
                <mo>)</mo>
            </mrow>
            <mo>,</mo>
            <mrow>
                <mi>O</mi>
                <mo>&#x2061;</mo>
                <mfenced separators=";">
                    <mi>x</mi>
                    <mi>&#8734;</mi>
                </mfenced>
            </mrow>
            <mo>}</mo>
            <mo>.</mo>
        </math>
    </p>
    <p>Пример 6.6.4. Найдем сумму R точек P(2, 9) и Q(6, 5) по формулам <a href="#f6.6.2">(6.6.2)</a> и <a
            href="#f6.6.3">(6.6.3)</a>:
        <math>
            <mrow>
                <mi>&#x03bb;</mi>
                <mo>=</mo>
                <mfrac>
                    <mrow>
                        <mn>5</mn>
                        <mo>-</mo>
                        <mn>9</mn>
                    </mrow>
                    <mrow>
                        <mn>6</mn>
                        <mo>-</mo>
                        <mn>2</mn>
                    </mrow>
                </mfrac>
                <mo>=</mo>
                <mrow>
                    <mo>-</mo>
                    <mn>1</mn>
                </mrow>
                <mo>=</mo>
                <mn>10</mn>
                <mo>(</mo>
                <mo>mod</mo>
                <mn>11</mn>
                <mo>)</mo>
            </mrow>
            <mo>,</mo>
            <mrow>
                <msub>
                    <mi>R</mi>
                    <mi>x</mi>
                </msub>
                <mo>=</mo>
                <mrow>
                    <mn>36</mn>
                    <mo>-</mo>
                    <mn>7</mn>
                    <mo>-</mo>
                    <mn>3</mn>
                </mrow>
                <mo>=</mo>
                <mn>26</mn>
                <mo>=</mo>
                <mn>4</mn>
                <mo>(</mo>
                <mo>mod</mo>
                <mn>11</mn>
                <mo>)</mo>
            </mrow>
            <mo>,</mo>
            <mrow>
                <msub>
                    <mi>R</mi>
                    <mi>y</mi>
                </msub>
                <mo>=</mo>
                <mrow>
                    <mo>-</mo>
                    <mn>9</mn>
                </mrow>
                <mo>-</mo>
                <mrow>
                    <mo>(</mo>
                    <mn>4</mn>
                    <mo>-</mo>
                    <mn>2</mn>
                    <mo>)</mo>
                </mrow>
                <mo>=</mo>
                <mrow>
                    <mo>-</mo>
                    <mn>29</mn>
                </mrow>
                <mo>=</mo>
                <mn>4</mn>
                <mo>(</mo>
                <mo>mod</mo>
                <mn>11</mn>
                <mo>)</mo>
            </mrow>
            <mo>.</mo>
        </math>
    </p>
    <p>Таким образом, суммой точек P(2, 9) и Q(6, 5) является точка R(4, 4) на эллиптической кривой над конечным полем
        <math>
            <msub>
                <mi>F</mi>
                <mn>11</mn>
            </msub>
        </math>
        .
    </p>
    <p>Пример 6.5.5. Вычислим сумму точек P(3, 10) и Q(7, 8) эллиптической кривой над конечным полем
        <math>
            <msub>
                <mi>F</mi>
                <mn>11</mn>
            </msub>
        </math>
        .
    </p>
    <p>По формуле <a href="#f6.6.2">(6.6.2)</a> вычислим угловой коэффициент касательной:
        <math>
            <mi>&#x03bb;</mi>
            <mo>=</mo>
            <mfrac>
                <mrow>
                    <mn>8</mn>
                    <mo>-</mo>
                    <mn>10</mn>
                </mrow>
                <mrow>
                    <mn>7</mn>
                    <mo>-</mo>
                    <mn>3</mn>
                </mrow>
            </mfrac>
            <mrow>
                <mo>(</mo>
                <mo>mod</mo>
                <mn>11</mn>
                <mo>)</mo>
            </mrow>
            <mo>=</mo>
            <mrow>
                <mo>-</mo>
                <msup>
                    <mn>2</mn>
                    <mrow>
                        <mo>-</mo>
                        <mn>1</mn>
                    </mrow>
                </msup>
            </mrow>
            <mrow>
                <mo>(</mo>
                <mo>mod</mo>
                <mn>11</mn>
                <mo>)</mo>
            </mrow>
            <mo>.</mo>
        </math>
        К элементу
        <math>
            <mn>2</mn>
        </math>
        обратным элементом в
        <math>
            <msub>
                <mi>F</mi>
                <mn>11</mn>
            </msub>
        </math>
        является элемент
        <math>
            <mn>6</mn>
        </math>
        , так как
        <math>
            <mrow>
                <mn>2</mn>
                <mo>&#183;</mo>
                <mn>6</mn>
            </mrow>
            <mo>mod</mo>
            <mn>11</mn>
            <mo>=</mo>
            <mn>1</mn>
        </math>
        Противоположным элементом к элементу
        <math>
            <mn>6</mn>
        </math>
        является элемент
        <math>
            <mn>5</mn>
        </math>
        . Следовательно,
        <math>
            <mi>&#x03bb;</mi>
            <mo>=</mo>
            <mn>5</mn>
        </math>
        .
    </p>
    <p>По формуле <a href="#f6.6.3">(6.6.3)</a> вычислим сумму точек P(2, 9) и Q(6, 5):
        <math>
            <mrow>
                <msub>
                    <mi>R</mi>
                    <mi>x</mi>
                </msub>
                <mo>=</mo>
                <mrow>
                    <mn>25</mn>
                    <mo>-</mo>
                    <mn>7</mn>
                    <mo>-</mo>
                    <mn>3</mn>
                </mrow>
                <mo>=</mo>
                <mn>15</mn>
                <mo>=</mo>
                <mn>4</mn>
                <mo>(</mo>
                <mo>mod</mo>
                <mn>11</mn>
                <mo>)</mo>
            </mrow>
            <mo>,</mo>
            <mrow>
                <msub>
                    <mi>R</mi>
                    <mi>y</mi>
                </msub>
                <mo>=</mo>
                <mrow>
                    <mo>-</mo>
                    <mn>10</mn>
                </mrow>
                <mo>-</mo>
                <mrow>
                    <mn>5</mn>
                    <mo>&#x2062;</mo>
                    <mo>(</mo>
                    <mn>4</mn>
                    <mo>-</mo>
                    <mn>3</mn>
                    <mo>)</mo>
                </mrow>
                <mo>=</mo>
                <mrow>
                    <mo>-</mo>
                    <mn>15</mn>
                </mrow>
                <mo>=</mo>
                <mn>7</mn>
                <mo>(</mo>
                <mo>mod</mo>
                <mn>11</mn>
                <mo>)</mo>
            </mrow>
        </math>
        .
        Следовательно, суммой точек P(2, 9) и Q(6, 5) будет точка
        <math>
            <mrow>
                <mi>R</mi>
                <mo>(</mo>
                <mn>4</mn>
                <mo>,</mo>
                <mn>7</mn>
                <mo>)</mo>
            </mrow>
        </math>
        .
    </p>
</div>
<p>Ниже представлена форма для вычисления эллиптической кривой над конечным полем по заданному модулю
    <math>
        <mi>p</mi>
    </math>
    :
</p>
<form id="f1">
    Задайте модуль поля<input type="text" id='module' size='4'/><br/>
    Эллиптическая кривая над конечным полем:<br/>
    <textarea rows="5" id="text_result" cols="80"></textarea><br/>
    <input type="button" value="Вычислить" onclick="f1()"/>
    <input type="reset" value="Обновить"/>
</form>
<p>Далее следуют калькуляторы, вычисляющие сумму двух точек, удвоенную точку и скалярное произведение целого числа и
    точки эллиптической кривой над конечным полем:</p>
<p>Сумма двух точек эллиптической кривой над конечным полем:</p>
<form id="f2">
    Задайте модуль поля<input type="text" id='module2' size='4'/><br/>
    x1:<input type="text" id='f2x1' size='4'/> y1: <input type="text" id='f2y1' size='4'/><br/>
    x2:<input type="text" id='f2x2' size='4'/> y2: <input type="text" id='f2y2' size='4'/><br/>
    <input type="button" value="Вычислить"
           onclick="sumf2(module2.value, f2x1.value, f2y1.value, f2x2.value, f2y2.value)"/>
    <input type="reset" value="Обновить"/>
</form>
<div id='f2result'></div>
<p>Удвоение точки эллиптической кривой над конечным полем:</p>
<form id="f3">
    Задайте модуль поля<input type="text" id='module3' size='4'/><br/>
    x:<input type="text" id='f3x' size='4'/> y: <input type="text" id='f3y' size='4'/><br/>
    <input type="button" value="Вычислить" onclick="f3double(module3.value, f3x.value, f3y.value)"/>
    <input type="reset" value="Обновить"/>
</form>
<div id='f3result'></div>

<p>Скалярное произведение целого числа на точку эллиптической кривой над конечным полем:</p>
<form id="f4">
    Задайте модуль поля<input type="text" id='f4mod' size='4'/><br/>
    Задайте n<input type="text" id='f4n' size='4'/><br/>
    Базовая точка: x=<input type="text" id='f4x' size='4'/> y= <input type="text" id='f4y' size='4'/><br/>
    <input type="button" value="Вычислить" onclick="gen_cluch(f4mod.value, f4n.value, f4x.value, f4y.value)"/>
    <input type="reset" value="Обновить"/>
</form>
<div id='f4result'></div>


<h3>6.6.3. Эллиптическая криптография</h3>
<p>Чтобы использовать ECDSA, такой протокол как Биткойн должен зафиксировать набор параметров для эллиптической кривой и
    ее конечного поля, чтобы эти параметры знали и применяли все пользователи протокола.</p>
<p>Эти зафиксированные параметры включают в себя уравнение кривой, значение модуля поля и базовую точку
    <math>
        <mi>P</mi>
    </math>
    , принадлежащую эллиптической кривой, и порядок
    <math>
        <mi>q</mi>
    </math>
    базовой точки
    <math>
        <mi>P</mi>
    </math>
    .
</p>
<p><span class="teorema">Наименьшее простое натуральное число <math><mi>q</mi></math>, удовлетворяющее условию
<math><mrow><mi>q</mi><mo>&#x2062;</mo><mi>P</mi></mrow><mo>=</mo><mrow><mi>O</mi><mo>&#x2061;</mo><mfenced
        separators=";"><mi>x</mi><mi>&#8734;</mi></mfenced></mrow></math>, называется порядком базовой точки  <math><mi>P</mi></math>.</span>
</p>
<p>Известно, что порядок базовой точки эллиптической кривой над конечным полем является делителем <a href='#por_grupp'>порядка
    группы
    <math>
        <msub>
            <mi>GF</mi>
            <mi>p</mi>
        </msub>
    </math>
</a>.
</p>
<p>Вычисление порядка базовой точки:</p>
<form id="f5">
    Задайте модуль поля<input type="text" id='f5mod' size='4'/><br/>
    Базовая точка: x=<input type="text" id='f5x' size='4'/> y= <input type="text" id='f5y' size='4'/><br/>
    <input type="button" value="Вычислить" onclick="gen_por(f5mod.value, f5x.value, f5y.value)"/>
    <input type="reset" value="Обновить"/>
</form>
<div id='f5result'></div>
<p>Для всех этих параметров Биткойн использует очень большие числа. Это важно, поскольку безопасность этого алгоритма
    опирается на то, что эти значения слишком большие, чтобы подобрать что-то простым перебором или &quot;брутфорсом&quot;.</p>
<p>В случае Биткойна эти значения таковы (запись чисел дана не в десятичном, а в более компактном шестнадцатеричном
    виде, привычном программистам):</p>
<ol>
    <li>Уравнение эллиптической кривой <a href="#f6.6.1">(6.6.1)</a>.</li>
    <li>Простой модуль
        <math display="block">
            <mi>p</mi>
            <mo>=</mo>
            <mn>FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFE FFFFFC2F</mn>
            <mo>.</mo>
        </math>
    </li>
    <li>Базовая точка
        <math>
            <mi>P</mi>
            <mo>=</mo>
            <mn>04 79BE667E F9DCBBAC 55A06295 CE870B07 029BFCDB 2DCE28D9 59F2815B 16F81798 483ADA77 26A3C465 5DA4FBFC
                0E1108A8 FD17B448 A6855419 9C47D08F FB10D4B8
            </mn>
        </math>
        .
    </li>
    <li>Порядок базовой точки
        <math>
            <mi>q</mi>
            <mo>=</mo>
            <mn>FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFE BAAEDCE6 AF48A03B BFD25E8C D0364141</mn>
        </math>
        .
    </li>
</ol>
<p>Данная конкретная реализация ECDSA известна как secp256k1 и является частью семейства стандартов, предлагаемых для
    использования в криптографии.</p>
<p>В ECDSA секретный ключ — это просто случайное число между 1 и значением порядка базовой точки. Открытый же ключ
    получается из секретного при помощи операции скалярного умножения базовой точки на значение секретного ключа:
    открытый ключ = секретный ключ * базовая точка.</p>
<p>Это показывает, что максимально возможное количество секретных ключей (и, следовательно, биткойн-адресов) — конечно,
    и равно порядку базовой точки.</p>
<p>Вычисление открытого ключа разбивается на ряд операций удвоения и сложения точек, начиная с базовой точки по формулам
    (<a href="#f6.5.2">(6.6.2)</a>, <a href="#f6.6.3">(6.6.3)</a>, <a href="#f6.6.5">(6.6.5)</a>.</p>
<p>Как и секретный ключ, публичный ключ тоже, как правило, представляется в виде шестнадцатеричного числа. В несжатом
    формате публичный ключ — это просто записанные подряд два 256-битных числа, являющиеся его х и у координатами. Мы
    также можем воспользоваться свойством симметрии эллиптической кривой для получения сжатого публичного ключа — в этом
    формате он содержит лишь значение координаты х и информацию о том, на какой половине кривой находится точка — на
    нижней, или на верхней. Из этой информации мы можем восстановить обе координаты, подставив в уравнение кривой.</p>

<p>Пример 6.6.6. Пусть задана эллиптическая кривая <a href="#f6.6.1">(6.6.1)</a> над полем
    <math>
        <msub>
            <mi>F</mi>
            <mn>67</mn>
        </msub>
    </math>
    . В качестве базовой выберем точку
    <math>
        <mi>P</mi>
        <mo>(</mo>
        <mn>2</mn>
        <mo>,</mo>
        <mn>45</mn>
        <mo>)</mo>
    </math>
    , порядок которой будет равен простому числу
    <math>
        <mn>79</mn>
    </math>
    . Пусть секретным ключом будет число
    <math>
        <mn>5</mn>
    </math>
    из диапазона
    <math>
        <mo>(</mo>
        <mn>1</mn>
        <mo>;</mo>
        <mn>79</mn>
        <mo>)</mo>
    </math>
    , и требуется вычислить публичный ключ.
</p>
<p>Для вычисления публичного ключа как произведения секретного ключа на базовую точку представим число 5 в двоичной
    системе счисления:
    <math>
        <msub>
            <mn>5</mn>
            <mn>10</mn>
        </msub>
        <mo>=</mo>
        <msub>
            <mn>101</mn>
            <mn>2</mn>
        </msub>
    </math>
    .
    Следовательно, публичный ключ будет представлять сумма точек
    <math>
        <mn>4</mn>
        <mo>&#x2062;
        </mo<>
        <mi>P</mi>
        <mo>+</mo>
        <mi>P</mi>
    </math>
    .
</p>
<p>Вычислим по формулам <a href="#f6.6.4">(6.6.4)</a> и <a href="#f6.6.5">(6.6.5)</a> точку 2P:
    <math display="block">
        <mtable>
            <mtr>
                <mtd>
                    <mi>&#x03bb;</mi>
                    <mo>=</mo>
                    <mfrac>
                        <mrow>
                            <mn>3</mn>
                            <mo>&#183;</mo>
                            <msup>
                                <mn>2</mn>
                                <mn>2</mn>
                            </msup>
                        </mrow>
                        <mrow>
                            <mn>2</mn>
                            <mo>&#183;</mo>
                            <mn>45</mn>
                        </mrow>
                    </mfrac>
                    <mo>=</mo>
                    <mfrac>
                        <mn>2</mn>
                        <mn>15</mn>
                    </mfrac>
                    <mo>=</mo>
                    <mrow>
                        <mn>2</mn>
                        <mo>&#183;</mo>
                        <mn>9</mn>
                    </mrow>
                    <mo>=</mo>
                    <mn>18</mn>
                    <mrow>
                        <mo>(</mo>
                        <mo>mod</mo>
                        <mn>67</mn>
                        <mo>)</mo>
                    </mrow>
                    <mo>,</mo>
                </mtd>
            </mtr>
            <mtr>
                <mtd>
                    <msub>
                        <mi>R</mi>
                        <mi>x</mi>
                    </msub>
                    <mo>=</mo>
                    <mrow>
                        <msup>
                            <mn>18</mn>
                            <mn>2</mn>
                        </msup>
                        <mo>-</mo>
                        <mrow>
                            <mn>2</mn>
                            <mo>&#183;</mo>
                            <mn>2</mn>
                        </mrow>
                    </mrow>
                    <mo>=</mo>
                    <mrow>
                        <mn>52</mn>
                    </mrow>
                    <mrow>
                        <mo>(</mo>
                        <mo>mod</mo>
                        <mn>67</mn>
                        <mo>)</mo>
                    </mrow>
                    <mo>,</mo>
                </mtd>
            </mtr>
            <mtr>
                <mtd>
                    <msub>
                        <mi>R</mi>
                        <mi>y</mi>
                    </msub>
                    <mo>=</mo>
                    <mrow>
                        <mo>-</mo>
                        <mn>45</mn>
                    </mrow>
                    <mo>-</mo>
                    <mn>9</mn>
                    <mo>&#183;</mo>
                    <mrow>
                        <mo>(</mo>
                        <mn>52</mn>
                        <mo>-</mo>
                        <mn>2</mn>
                        <mo>)</mo>
                    </mrow>
                    </mrow>
                    <mo>=</mo>
                    <mrow>
                        <mn>60</mn>
                        <mrow>
                            <mo>(</mo>
                            <mo>mod</mo>
                            <mn>67</mn>
                            <mo>)</mo>
                        </mrow>
                    </mrow>
                    <mo>.</mo>
                </mtd>
            </mtr>
    </math>
</p>
<p>Таким образом, точка
    <math>
        <mn>2</mn>
        <mo>&#x2062;</mo>
        <mi>P</mi>
    </math>
    имеет следующие координаты:
    <math>
        <mo>(</mo>
        <mn>52</mn>
        <mo>;</mo>
        <mn>60</mn>
        <mo>)</mo>
    </math>
    .
</p>
<p>Для вычисления точки
    <math>
        <mn>4</mn>
        <mo>&#x2062;</mo>
        <mi>P</mi>
    </math>
    к координатам точки
    <math>
        <mn>2</mn>
        <mo>&#x2062;</mo>
        <mi>P</mi>
    </math>
    применим формулы <a href="#f6.6.4">(6.6.4)</a> и <a href="#f6.6.5">(6.6.5)</a>:
    <math display="block">
        <mtable>
            <mtr>
                <mtd>
                    <mi>&#x03bb;</mi>
                    <mo>=</mo>
                    <mfrac>
                        <mrow>
                            <mn>3</mn>
                            <mo>&#183;</mo>
                            <msup>
                                <mn>52</mn>
                                <mn>2</mn>
                            </msup>
                        </mrow>
                        <mrow>
                            <mn>2</mn>
                            <mo>&#183;</mo>
                            <mn>60</mn>
                        </mrow>
                    </mfrac>
                    <mo>=</mo>
                    <mfrac>
                        <mn>338</mn>
                        <mn>5</mn>
                    </mfrac>
                    <mo>=</mo>
                    <mrow>
                        <mn>338</mn>
                        <mo>&#183;</mo>
                        <mn>27</mn>
                    </mrow>
                    <mo>=</mo>
                    <mn>14</mn>
                    <mrow>
                        <mo>(</mo>
                        <mo>mod</mo>
                        <mn>67</mn>
                        <mo>)</mo>
                    </mrow>
                    <mo>,</mo>
                </mtd>
            </mtr>
            <mtr>
                <mtd>
                    <msub>
                        <mi>R</mi>
                        <mi>x</mi>
                    </msub>
                    <mo>=</mo>
                    <mrow>
                        <msup>
                            <mn>14</mn>
                            <mn>2</mn>
                        </msup>
                        <mo>-</mo>
                        <mrow>
                            <mn>2</mn>
                            <mo>&#183;</mo>
                            <mn>52</mn>
                        </mrow>
                    </mrow>
                    <mo>=</mo>
                    <mn>25</mn>
                    <mrow>
                        <mo>(</mo>
                        <mo>mod</mo>
                        <mn>67</mn>
                        <mo>)</mo>
                    </mrow>
                    <mo>,</mo>
                </mtd>
            </mtr>
            <mtr>
                <mtd>
                    <msub>
                        <mi>R</mi>
                        <mi>y</mi>
                    </msub>
                    <mo>=</mo>
                    <mrow>
                        <mo>-</mo>
                        <mn>60</mn>
                    </mrow>
                    <mo>-</mo>
                    <mn>14</mn>
                    <mo>&#183;</mo>
                    <mrow>
                        <mo>(</mo>
                        <mn>25</mn>
                        <mo>-</mo>
                        <mn>52</mn>
                        <mo>)</mo>
                    </mrow>
                    </mrow>
                    <mo>=</mo>
                    <mn>50</mn>
                    <mrow>
                        <mo>(</mo>
                        <mo>mod</mo>
                        <mn>67</mn>
                        <mo>)</mo>
                    </mrow>
                    <mo>.</mo>
                </mtd>
            </mtr>
    </math>
</p>
<p>Остается вычислить по формулам <a href="#f6.6.2">(6.6.2)</a> и <a href="#f6.6.3">(6.6.3)</a> сумму
    <math>
        <mn>4</mn>
        <mo>&#x2062;
        </mo<>
        <mi>P</mi>
        <mo>+</mo>
        <mi>P</mi>
    </math>
    :
    <math display="block">
        <mtable>
            <mtr>
                <mtd>
                    <mi>&#x03bb;</mi>
                    <mo>=</mo>
                    <mfrac>
                        <mrow>
                            <mn>50</mn>
                            <mo>-</mo>
                            </mn>
                            <mn>45</mn>
                            </msup></mrow>
                        <mrow>
                            <mn>25</mn>
                            <mo>-</mo>
                            <mn>2</mn>
                        </mrow>
                    </mfrac>
                    <mo>=</mo>
                    <mfrac>
                        <mn>5</mn>
                        <mn>23</mn>
                    </mfrac>
                    <mo>=</mo>
                    <mrow>
                        <mn>5</mn>
                        <mo>&#183;</mo>
                        <mn>35</mn>
                    </mrow>
                    <mo>=</mo>
                    <mn>41</mn>
                    <mrow>
                        <mo>(</mo>
                        <mo>mod</mo>
                        <mn>67</mn>
                        <mo>)</mo>
                    </mrow>
                    <mo>,</mo>
                </mtd>
            </mtr>
            <mtr>
                <mtd>
                    <msub>
                        <mi>R</mi>
                        <mi>x</mi>
                    </msub>
                    <mo>=</mo>
                    <mrow>
                        <msup>
                            <mn>41</mn>
                            <mn>2</mn>
                        </msup>
                        <mo>-</mo>
                        <mn>2</mn>
                        <mo>-</mo>
                        <mn>25</mn>
                    </mrow>
                    <mo>=</mo>
                    <mn>46</mn>
                    <mrow>
                        <mo>(</mo>
                        <mo>mod</mo>
                        <mn>67</mn>
                        <mo>)</mo>
                    </mrow>
                    <mo>,</mo>
                </mtd>
            </mtr>
            <mtr>
                <mtd>
                    <msub>
                        <mi>R</mi>
                        <mi>y</mi>
                    </msub>
                    <mo>=</mo>
                    <mrow>
                        <mo>-</mo>
                        <mn>45</mn>
                    </mrow>
                    <mo>-</mo>
                    <mn>41</mn>
                    <mo>&#183;</mo>
                    <mrow>
                        <mo>(</mo>
                        <mn>46</mn>
                        <mo>-</mo>
                        <mn>2</mn>
                        <mo>)</mo>
                    </mrow>
                    </mrow>
                    <mo>=</mo>
                    <mn>27</mn>
                    <mrow>
                        <mo>(</mo>
                        <mo>mod</mo>
                        <mn>67</mn>
                        <mo>)</mo>
                    </mrow>
                    <mo>.</mo>
                </mtd>
            </mtr>
    </math>
</p>
<p>Публичным ключом будет последовательность координат точки
    <math>
        <mn>4</mn>
        <mo>&#x2062;
        </mo<>
        <mi>P</mi>
        <mo>+</mo>
        <mi>P</mi>
    </math>
    :
    <math>
        <mn>46</mn>
        <mn>;</mn>
        <mn>27</mn>
    </math>
    .
</p>

<p>Генерирование публичного ключа:</p>
<form id="f6">
    Задайте модуль поля<input type="text" id='f6mod' size='4'/><br/>
    Задайте секретный ключ s <input type="text" id='f6s' size='4'/><br/>
    Задайте базовую точку P с простым порядком: x=<input type="text" id='f6x' size='4'/> y= <input type="text" id='f6y'
                                                                                                   size='4'/><br/>
    Задайте порядок q базовой точки <input type="text" id='f6q' size='4'/><br/>
    <input type="button" value="Вычислить" onclick="gen_open(f6mod.value, f6s.value, f6q.value, f6x.value, f6y.value)"/>
    <input type="reset" value="Обновить"/>
</form>


<p>Перейдем к рассмотрению получения подписи
    <math>
        <mfenced>
            <msub>
                <mi>r</mi>
                <mi>x</mi>
            </msub>
            <msub>
                <mi>r</mi>
                <mi>y</mi>
            </msub>
        </mfenced>
    </math>
    посредством секретного ключа. Пусть
    <math>
        <mi>P</mi>
    </math>
    - базовая точка, порядок
    <math>
        <mi>q</mi>
    </math>
    которой является простым числом, а
    <math>
        <mi>d</mi>
    </math>
    - данные. В качестве секретного ключа берется случайное или псевдослучайное число
    <math>
        <mi>s</mi>
    </math>
    из интервала от 1 до
    <math>
        <mi>q</mi>
        <mo>-</mo>
        <mn>1</mn>
    </math>
    .
</p>
<ol>
    <li>В первую очередь, специальная хэш-функция хэширует данные
        <math>
            <mi>d</mi>
        </math>
        , т.е. по подписываемым данным (любой длины) вычисляет уникальное число
        <math>
            <mi>z</mi>
        </math>
        длиной 256 бит, называемый хэшем. Вычисленный хэш
        <math>
            <mi>z</mi>
        </math>
        служит идентификатором данных
        <math>
            <mi>d</mi>
        </math>
        по причине своей уникальности. Хэш-функция односторонняя - восстановление данных
        <math>
            <mi>d</mi>
        </math>
        по соответствующему хэшу
        <math>
            <mi>z</mi>
        </math>
        практически невозможно, так как требует огромных вычислительных мощностей и времени.
    </li>
    <li>
        <p>Далее выбирается случайное число
            <math>
                <mi>k</mi>
            </math>
            из интервала
            <math>
                <mfenced>
                    <mo>(</mo>
                    <mn>1</mn>
                    <mo>;</mo>
                    <mi>q</mi>
                    <mo>)</mo>
                </mfenced>
            </math>
            и вычисляется скалярное произведение
            <math>
                <mfenced>
                    <mo>(</mo>
                    <mi>x</mi>
                    <mo>;</mo>
                    <mi>y</mi>
                    <mo>)</mo>
                </mfenced>
                <mo>=</mo>
                <mi>k</mi>
                <mo>&#183;</mo>
                <mi>P</mi>
                <mrow>
                    <mo>(</mo>
                    <mo>mod</mo>
                    <mi>p</mi>
                    <mo>)</mo>
                </mrow>
            </math>
            .
        </p>
        <p>Если
            <math>
                <mi>x</mi>
                <mo>=</mo>
                <mn>0</mn>
            </math>
            , то следует выбрать другое число
            <math>
                <mi>k</mi>
            </math>
            и повторить вычисления.
        </p>
    </li>
    <li>
        <p>В качестве
            <math>
                <msub>
                    <mi>r</mi>
                    <mi>x</mi>
                </msub>
            </math>
            берется
            <math>
                <mi>x</mi>
            </math>
            и вычисляется
            <math>
                <msub>
                    <mi>r</mi>
                    <mi>y</mi>
                </msub>
                <mo>=</mo>
                <mfrac>
                    <mrow>
                        <mi>z</mi>
                        <mo>+</mo>
                        <msub>
                            <mi>r</mi>
                            <mi>x</mi>
                        </msub>
                        <mo>&#x2062;</mo>
                        <mi>s</mi>
                    </mrow>
                    <mi>k</mi>
                </mfrac>
                <mrow>
                    <mo>(</mo>
                    <mo>mod</mo>
                    <mi>q</mi>
                    <mo>)</mo>
                </mrow>
            </math>
            .
        </p>
        <p>Если
            <math>
                <msub>
                    <mi>r</mi>
                    <mi>y</mi>
                </msub>
                <mo>=</mo>
                <mn>0</mn>
            </math>
            , то следует вернуться к выбору числа
            <math>
                <mi>k</mi>
            </math>
            и повторению вычисления
            <math>
                <mfenced>
                    <msub>
                        <mi>r</mi>
                        <mi>x</mi>
                    </msub>
                    <msub>
                        <mi>r</mi>
                        <mi>y</mi>
                    </msub>
                </mfenced>
            </math>
            .
        </p>
    </li>
</ol>


<p>Пример 6.6.7. Как и в примере 6.6.6, пусть задана эллиптическая кривая <a href="#f6.6.1">(6.6.1)</a> над полем
    <math>
        <msub>
            <mi>F</mi>
            <mn>67</mn>
        </msub>
    </math>
    , базовой точкой служит
    <math>
        <mi>P</mi>
        <mrow>
            <mfenced>
                <mo>(</mo>
                <mn>2</mn>
                <mo>;</mo>
                <mn>45</mn>
                <mo>)</mo>
            </mfenced>
        </mrow>
    </math>
    , имеющий простой порядок
    <math>
        <mi>q</mn>
            <mo>=</mo>
            <mn>79</mn>
    </math>
    , секретный ключ
    <math>
        <mi>s</mi>
        <mo>=</mo>
        <mn>7</mn>
    </math>
    , хэш
    <math>
        <mi>z</mn>
            <mo>=</mo>
            <mn>17</mn>
    </math>
    . Вычислим подпись для хэша
    <math>
        <mi>z</mn>
            <mo>=</mo>
            <mn>17</mn>
    </math>
    .
</p>
<p>Пусть для хэша
    <math>
        <mi>z</mn>
            <mo>=</mo>
            <mn>17</mn>
    </math>
    выбрали случайное число
    <math>
        <mi>k</mi>
        <mo>=</mo>
        <mn>5</mn>
    </math>
    из интервала от
    <math>
        <mn>1</mn>
    </math>
    до
    <math>
        <mn>79</mn>
    </math>
    . Вычислим произведение
    <math>
        <mo>(</mo>
        <mi>x</mi>
        <mo>;</mo>
        <mi>y</mi>
        <mo>)</mo>
        <mo>=</mo>
        <mrow>
            <mn>5</mn>
            <mo>&#x2062;</mo>
            <mi>P</mi>
        </mrow>
        <mo>=</mo>
        <mrow>
            <mo>(</mo>
            <mn>46</mn>
            <mo>;</mo>
            <mn>27</mn>
            <mo>)</mo>
        </mrow>
        <mrow>
            <mo>(</mo>
            <mo>mod</mo>
            <mn>67</mn>
            <mo>)</mo>
        </mrow>
    </math>
    .
</p>
<p>
    <math>
        <msub>
            <mi>r</mi>
            <mi>x</mi>
        </msub>
        <mo>=</mo>
        <mn>46</mn>
    </math>
    . Вычислим
    <math>
        <msub>
            <mi>r</mi>
            <mi>y</mi>
        </msub>
        <mo>=</mo>
        <mfrac>
            <mrow>
                <mn>17</mn>
                <mo>+</mo>
                <mrow>
                    <mn>46</mn>
                    <mo>&#183;</mo>
                    <mn>7</mn>
                </mrow>
            </mrow>
            <mn>5</mn>
        </mfrac>
        <mrow>
            <mo>(</mo>
            <mo>mod</mo>
            <mn>79</mn>
            <mo>)</mo>
        </mrow>
    </math>
    .
</p>
<p>Нетрудно проверить, что
    <math>
        <mrow>
            <mn>5</mn>
            <mo>&#183;</mo>
            <mn>16</mn>
        </mrow>
        <mo>=</mo>
        <mn>1</mn>
        <mrow>
            <mo>(</mo>
            <mo>mod</mo>
            <mn>79</mn>
            <mo>)</mo>
        </mrow>
    </math>
    , следовательно,
    <math>
        <msup>
            <mn>5</mn>
            <mrow>
                <mo>-</mo>
                <mn>1</mn>
            </mrow>
        </msup>
        <mo>=</mo>
        <mn>16</mn>
        <mrow>
            <mo>(</mo>
            <mo>mod</mo>
            <mn>79</mn>
            <mo>)</mo>
        </mrow>
    </math>
    . Тогда
    <math>
        <msub>
            <mi>r</mi>
            <mi>y</mi>
        </msub>
        <mo>=</mo>
        <mfrac>
            <mrow>
                <mn>17</mn>
                <mo>+</mo>
                <mrow>
                    <mn>46</mn>
                    <mo>&#183;</mo>
                    <mn>7</mn>
                </mrow>
            </mrow>
            <mn>5</mn>
        </mfrac>
        <mrow>
            <mo>(</mo>
            <mo>mod</mo>
            <mn>79</mn>
            <mo>)</mo>
        </mrow>
        <mo>=</mo>
        <mrow>
            <mo>(</mo>
            <mn>17</mn>
            <mo>+</mo>
            <mrow>
                <mn>46</mn>
                <mo>&#183;</mo>
                <mn>7</mn>
                <mo>)</mo>
            </mrow>
            <mo>&#183;</mo>
            <mn>16</mn>
            <mo>=</mo>
            <mn>52</mn>
            <mo>(</mo>
            <mo>mod</mo>
            <mn>79</mn>
            <mo>)</mo>
        </mrow>
    </math>
    .
</p>
<p>Для хэша
    <math>
        <mi>z</mn>
            <mo>=</mo>
            <mn>17</mn>
    </math>
    подписью будет служить строка
    <math>
        <mn>4652</mn>
    </math>
    . На практике подпись представляется в шестнадцатеричном формате.
</p>

<p>Генерирование подписи:</p>
<form id="f7">
    Задайте модуль поля <input type="text" id='f7mod' size='4'/><br/>
    Задайте хэш <input type="text" id='f7z' size='4'/><br/>
    Задайте секретный ключ s <input type="text" id='f7s' size='4'/><br/>
    Задайте базовую точку P с простым порядком: x=<input type="text" id='f7x' size='4'/> y= <input type="text" id='f7y'
                                                                                                   size='4'/><br/>
    Задайте порядок q базовой точки <input type="text" id='f7q' size='4'/><br/>
    Задайте случайное число k <input type="text" id='f7k' size='4'/><br/>
    <input type="button" value="Вычислить"
           onclick="gen_podpis(f7mod.value, f7z.value, f7s.value, f7q.value, f7k.value, f7x.value, f7y.value)"/>
    <input type="reset" value="Обновить"/>
</form>


<p>Подпись служит для проверки третьей стороной достоверности данных по представленной подписи и публичному ключу. Шаги
    проверки достоверности данных
    <math>
        <mi>z</mi>
    </math>
    такие:
<ol>
    <li>убедиться, что компоненты подписи
        <math>
            <mfenced>
                <msub>
                    <mi>r</mi>
                    <mi>x</mi>
                </msub>
                <msub>
                    <mi>r</mi>
                    <mi>y</mi>
                </msub>
            </mfenced>
        </math>
        из диапазона от
        <math>
            <mn>1</mn>
        </math>
        до
        <math>
            <mi>q</mi>
            <mo>-</mo>
            <mn>1</mn>
        </math>
        , где
        <math>
            <mi>q</mo>
        </math>
        - порядок базовой точки;
    </li>
    <li>вычислить
        <math>
            <mi>w</mi>
            <mo>=</mo>
            <msubsup>
                <mi>r</mi>
                <mi>y</mi>
                <mrow>
                    <mo>-</mo>
                    <mn>1</mn>
                </mrow>
            </msubsup>
            <mo>(</mo>
            <mo>mod</mo>
            <mi>q</mi>
            <mo>)</mo>
            </mrow></math>
        ;
    </li>
    <li>вычислить
        <math>
            <mi>u</mi>
            <mo>=</mo>
            <mi>z</mi>
            <mo>&#x2062;</mo>
            <mi>w</mi>
            <mo>(</mo>
            <mo>mod</mo>
            <mi>q</mi>
            <mo>)</mo>
            </mrow>
        </math>
        ;
    </li>
    <li>вычислить
        <math>
            <mi>v</mi>
            <mo>=</mo>
            <msub>
                <mi>r</mi>
                <mi>x</mi>
            </msub>
            <mo>&#x2062;</mo>
            <mi>w</mi>
            <mrow>
                <mo>(</mo>
                <mo>mod</mo>
                <mi>q</mi>
                <mo>)</mo>
            </mrow>
        </math>
        ;
    </li>
    <li>вычислить точку
        <math>
            <mfenced>
                <mi>x</mi>
                <mi>y</mi>
            </mfenced>
            <mo>=</mo>
            <mrow>
                <mi>u</mi>
                <mo>&#x2062;</mo>
                <mi>P</mi>
            </mrow>
            <mo>+</mo>
            <mrow>
                <mi>v</mi>
                <mo>&#x2062;</mo>
                <mi>Q</mi>
            </mrow>
        </math>
        , где
        <math>
            <mi>P</mi>
        </math>
        - базовая точка,
        <math>
            <mi>Q</mi>
        </math>
        - публичный ключ;
    </li>
    <li>убедиться, что
        <math>
            <msub>
                <mi>r</mi>
                <mi>x</mi>
            </msub>
            <mo>=</mo>
            <mi>x</mi>
            <mrow>
                <mo>(</mo>
                <mo>mod</mo>
                <mi>q</mi>
                <mo>)</mo>
            </mrow>
        </math>
        . Если же это условие не выполняется, то подпись недействительна.
    </li>
</ol>
</p>
<p>Пример 6.5.8. </p>

<ol>
    <li>Координаты точки
        <math>
            <mfenced>
                <mn>46</mn>
                <mn>52</mn>
            </mfenced>
        </math>
        принадлежат интервалу
        <math>
            <mfenced>
                <mn>1</mn>
                <mn>79</mn>
            </mfenced>
        </math>
        ;
    </li>
    <li>
        <math>
            <mi>w</mi>
            <mo>=</mo>
            <mfrac>
                <mn>1</mn>
                <mrow>
                    <mi>z</mi>
                    <mo>&#x2062;</mo>
                    <mi>y</mi>
                </mrow>
            </mfrac>
            <mo>=</mo>
            <mfrac>
                <mn>1</mn>
                <mn>52</mn>
            </mfrac>
            <mo>=</mo>
            <mn>38</mn>
            <mrow>
                <mo>(</mo>
                <mo>mod</mo>
                <mn>79</mn>
                <mo>)</mo>
            </mrow>
        </math>
        ;
    </li>
    <li>
        <math>
            <mi>u</mi>
            <mo>=</mo>
            <mrow>
                <mi>z</mi>
                <mo>&#x2062;</mo>
                <mi>w</mi>
            </mrow>
            <mo>=</mo>
            <mrow>
                <mn>17</mn>
                <mo>&#215;</mo>
                <mn>38</mn>
            </mrow>
            <mo>=</mo>
            <mn>14</mn>
            <mrow>
                <mo>(</mo>
                <mo>mod</mo>
                <mn>79</mn>
                <mo>)</mo>
            </mrow>
        </math>
        ;
    </li>
    <li>
        <math>
            <mi>v</mi>
            <mo>=</mo>
            <mrow>
                <msub>
                    <mi>r</mi>
                    <mi>x</mi>
                </msub>
                <mo>&#215;</mo>
                <mi>w</mi>
            </mrow>
            <mo>=</mo>
            <mrow>
                <mn>46</mn>
                <mo>&#215;</mo>
                <mn>38</mn>
            </mrow>
            <mo>=</mo>
            <mn>10</mn>
            <mrow>
                <mo>(</mo>
                <mo>mod</mo>
                <mn>79</mn>
                <mo>)</mo>
            </mrow>
        </math>
        ;
    </li>
    <li>
        <math>
            <mfenced>
                <mi>x</mi>
                <mi>y</mi>
            </mfenced>
            <mo>=</mo>
            <mrow>
                <mrow>
                    <mi>u</mi>
                    <mo>&#215;</mo>
                    <mi>P</mi>
                </mrow>
                <mo>+</mo>
                <mrow>
                    <mi>v</mi>
                    <mo>&#215;</mo>
                    <mi>Q</mi>
                </mrow>
            </mrow>
            <mo>=</mo>
            <mrow>
                <mrow>
                    <mn>14</mn>
                    <mo>&#x2062;</mo>
                    <mi>P</mi>
                </mrow>
                <mo>+</mo>
                <mrow>
                    <mn>10</mn>
                    <mo>&#x2062;</mo>
                    <mi>Q</mi>
                </mrow>
            </mrow>
            <mo>=</mo>
            <mrow>
                <mfenced>
                    <mn>5</mn>
                    <mn>47</mn>
                </mfenced>
                <mo>+</mo>
                <mfenced>
                    <mn>13</mn>
                    <mn>44</mn>
                </mfenced>
            </mrow>
            <mo>=</mo>
            <mfenced>
                <mn>46</mn>
                <mn>27</mn>
            </mfenced>
            <mrow>
                <mo>(</mo>
                <mo>mod</mo>
                <mn>67</mn>
                <mo>)</mo>
            </mrow>
        </math>
        .
    </li>
</ol>
<p>Так как x совпал с rx по модулю 79, то следует вывод о действительности подписи.</p>


<p>Проверка подписи:</p>
<form id="f8">
    Задайте модуль поля <input type="text" id='f8mod' size='4'/><br/>
    Задайте базовую точку P с простым порядком: x=<input type="text" id='f8px' size='4'/> y= <input type="text"
                                                                                                    id='f8py' size='4'/><br/>
    Задайте порядок q базовой точки <input type="text" id='f8p' size='4'/><br/>
    Задайте публичный ключ Q : qx=<input type="text" id='f8qx' size='4'/> qy= <input type="text" id='f8qy'
                                                                                     size='4'/><br/>
    Задайте хэш z <input type="text" id='f8z' size='4'/><br/>
    Задайте подпись : rx=<input type="text" id='f8rx' size='4'/> ry= <input type="text" id='f8ry' size='4'/><br/>
    <input type="button" value="Проверить"
           onclick="prov_podpis(f8mod.value, f8px.value, f8py.value, f8p.value, f8qx.value, f8qy.value, f8z.value, f8rx.value, f8ry.value)"/>
    <input type="reset" value="Обновить"/>
</form>


<h3>Упражнения</h3>
<ol>
    <li>Постройте конечное поле
        <math>
            <msub>
                <mi>F</mi>
                <mn>5</mn>
            </msub>
        </math>
        , в котором операции сложения и умножения выполняются по модулю
        <math>
            <mn>5</mn>
        </math>
        .
    </li>
    <li>Почему в качестве модуля конечного поля
        <math>
            <msub>
                <mi>F</mi>
                <mi>p</mi>
            </msub>
        </math>
        требуется задать простое число?
    </li>
    <li>Продемонстрируйте замкнутость конечного поля
        <math>
            <msub>
                <mi>F</mi>
                <mn>5</mn>
            </msub>
        </math>
        относительно операций сложения и умножения по модулю
        <math>
            <mn>5</mn>
        </math>
        .
    </li>
    <li>Как вычислить элемент, обратный к заданному элементу конечного поля по некоторому модулю?</li>
    <li>Постройте эллиптическую кривую над конечным полем
        <math>
            <msub>
                <mi>F</mi>
                <mn>5</mn>
            </msub>
        </math>
        .
    </li>
    <li>Чему равняется сумма двух точек эллиптической кривой над конечным полем
        <math>
            <msub>
                <mi>F</mi>
                <mi>p</mi>
            </msub>
        </math>
        с равными абсциссами? Приведите примеры вычислений суммы точек с совпадающими абсциссами эллиптической кривой
        над конечным полем
        <math>
            <msub>
                <mi>F</mi>
                <mn>5</mn>
            </msub>
        </math>
        .
    </li>
    <li>Вычислите удвоения каждой точки эллиптической кривой над конечным полем
        <math>
            <msub>
                <mi>F</mi>
                <mn>5</mn>
            </msub>
        </math>
    </li>
    <li>В каких случаях сумма двух точек эллиптической кривой над конечным полем будет равна бесконечно удаленной
        точке?
    </li>
    <li>Вычислите для некоторой точки
        <math>
            <mi>A</mi>
        </math>
        эллиптической кривой над конечным полем
        <math>
            <msub>
                <mi>F</mi>
                <mn>5</mn>
            </msub>
        </math>
        скалярные произведения
        <math>
            <mrow>
                <mn>3</mn>
                <mo>&#x2062;</mo>
                <mi>A</mi>
            </mrow>
            <mo>,</mo>
            <mrow>
                <mn>4</mn>
                <mo>&#x2062;</mo>
                <mi>A</mi>
            </mrow>
            <mo>,</mo>
            <mrow>
                <mn>5</mn>
                <mo>&#x2062;</mo>
                <mi>A</mi>
            </mrow>
            <mo>.</mo>
        </math>
    </li>
    <li>Для эллиптической кривой над конечным полем
        <math>
            <msub>
                <mi>F</mi>
                <mn>7</mn>
            </msub>
        </math>
        продемонстрируйте свойство замкнутости относительно операции сложения точек.
    </li>
    <li>Теорема Пуанкаре утверждает, что эллиптическая кривой над конечным полем
        <math>
            <msub>
                <mi>F</mi>
                <mi>p</mi>
            </msub>
        </math>
        , дополненная бесконечно удаленной точкой, образует коммутативную группу относительно операции сложения. Что это
        означает?
    </li>
    <li>В эллиптической кривой над полем
        <math>
            <msub>
                <mi>F</mi>
                <mn>59</mn>
            </msub>
        </math>
        подберите подходящую базовую точку для криптосистемы ECDSA.
    </li>
    <li>Как соотносятся порядок эллиптической кривой над конечным полем
        <math>
            <msub>
                <mi>F</mi>
                <mi>p</mi>
            </msub>
        </math>
        и порядок базовой точки из этой эллиптической кривой?
    </li>
    <li>Перечислите параметры, определяющие протокол Биткойна.</li>
    <li>Каким требованиям должны отвечать параметры, определяющие протокол Биткойна?</li>
    <li>Что обозначает аббревиатура (акроним) ECDSA?</li>
    <li>Что обозначает аббревиатура secp256k1?</li>
    <li>Как выбирается секретный ключ клиента Биткойна?</li>
    <li>Как вычисляется публичный ключ клиента Биткойна?</li>
    <li>Укажите размер в битах секретного ключа (публичного ключа)?</li>
    <li>Почему размер публичного ключа в два раза больше размера секретного ключа?</li>
    <li>Какие функции выполняет секретный ключ?</li>
    <li>Для чего служит публичный ключ?</li>
    <li>Кто создает подпись?</li>
    <li>Какую функцию выполняет подпись клиента Биткойна?</li>
    <li>Как вычисляется подпись клиента Биткойна?</li>
    <li>Как проверяется подлинность подписи (достоверность данных)?</li>
    <li>Что подписывают подписью?</li>
    <li>Что такое хэш данных?</li>
    <li>Можно ли вычислить данные по известному хэшу?</li>
</ol>
<p><a href="6_5.html">К предыдущему</a> <a href="index.html">К содержанию</a> <a href="7_1.html">К следующему</a></p>
</body>
<script type="text/javascript">
    MathJax.Hub.Configured()
</script>
</html>